{"version":3,"file":"app.js","mappings":"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","sources":["webpack://localwatch/external node-commonjs \"util\"","webpack://localwatch/./node_modules/readable-stream/errors-browser.js","webpack://localwatch/./node_modules/simple-peer/node_modules/err-code/index.js","webpack://localwatch/./node_modules/get-browser-rtc/index.js","webpack://localwatch/./src/p2p/connection.ts","webpack://localwatch/./node_modules/string_decoder/lib/string_decoder.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/from-browser.js","webpack://localwatch/external node-commonjs \"buffer\"","webpack://localwatch/./node_modules/randombytes/browser.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/end-of-stream.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/state.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/stream-browser.js","webpack://localwatch/./node_modules/readable-stream/lib/_stream_duplex.js","webpack://localwatch/./node_modules/readable-stream/readable-browser.js","webpack://localwatch/./node_modules/readable-stream/lib/_stream_readable.js","webpack://localwatch/external node-commonjs \"events\"","webpack://localwatch/./node_modules/ms/index.js","webpack://localwatch/./node_modules/queue-microtask/index.js","webpack://localwatch/./node_modules/readable-stream/lib/_stream_passthrough.js","webpack://localwatch/./node_modules/readable-stream/lib/_stream_transform.js","webpack://localwatch/./node_modules/util-deprecate/browser.js","webpack://localwatch/./node_modules/inherits/inherits_browser.js","webpack://localwatch/./node_modules/readable-stream/lib/_stream_writable.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/buffer_list.js","webpack://localwatch/./node_modules/debug/src/common.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/pipeline.js","webpack://localwatch/./node_modules/simple-peer/index.js","webpack://localwatch/./node_modules/debug/src/browser.js","webpack://localwatch/./node_modules/safe-buffer/index.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/destroy.js","webpack://localwatch/./node_modules/readable-stream/lib/internal/streams/async_iterator.js","webpack://localwatch/./src/sync/syncManager.ts","webpack://localwatch/webpack/bootstrap","webpack://localwatch/./renderer/app.ts"],"sourcesContent":["module.exports = require(\"util\");","'use strict';\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar codes = {};\n\nfunction createErrorType(code, message, Base) {\n  if (!Base) {\n    Base = Error;\n  }\n\n  function getMessage(arg1, arg2, arg3) {\n    if (typeof message === 'string') {\n      return message;\n    } else {\n      return message(arg1, arg2, arg3);\n    }\n  }\n\n  var NodeError =\n  /*#__PURE__*/\n  function (_Base) {\n    _inheritsLoose(NodeError, _Base);\n\n    function NodeError(arg1, arg2, arg3) {\n      return _Base.call(this, getMessage(arg1, arg2, arg3)) || this;\n    }\n\n    return NodeError;\n  }(Base);\n\n  NodeError.prototype.name = Base.name;\n  NodeError.prototype.code = code;\n  codes[code] = NodeError;\n} // https://github.com/nodejs/node/blob/v10.8.0/lib/internal/errors.js\n\n\nfunction oneOf(expected, thing) {\n  if (Array.isArray(expected)) {\n    var len = expected.length;\n    expected = expected.map(function (i) {\n      return String(i);\n    });\n\n    if (len > 2) {\n      return \"one of \".concat(thing, \" \").concat(expected.slice(0, len - 1).join(', '), \", or \") + expected[len - 1];\n    } else if (len === 2) {\n      return \"one of \".concat(thing, \" \").concat(expected[0], \" or \").concat(expected[1]);\n    } else {\n      return \"of \".concat(thing, \" \").concat(expected[0]);\n    }\n  } else {\n    return \"of \".concat(thing, \" \").concat(String(expected));\n  }\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith\n\n\nfunction startsWith(str, search, pos) {\n  return str.substr(!pos || pos < 0 ? 0 : +pos, search.length) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith\n\n\nfunction endsWith(str, search, this_len) {\n  if (this_len === undefined || this_len > str.length) {\n    this_len = str.length;\n  }\n\n  return str.substring(this_len - search.length, this_len) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes\n\n\nfunction includes(str, search, start) {\n  if (typeof start !== 'number') {\n    start = 0;\n  }\n\n  if (start + search.length > str.length) {\n    return false;\n  } else {\n    return str.indexOf(search, start) !== -1;\n  }\n}\n\ncreateErrorType('ERR_INVALID_OPT_VALUE', function (name, value) {\n  return 'The value \"' + value + '\" is invalid for option \"' + name + '\"';\n}, TypeError);\ncreateErrorType('ERR_INVALID_ARG_TYPE', function (name, expected, actual) {\n  // determiner: 'must be' or 'must not be'\n  var determiner;\n\n  if (typeof expected === 'string' && startsWith(expected, 'not ')) {\n    determiner = 'must not be';\n    expected = expected.replace(/^not /, '');\n  } else {\n    determiner = 'must be';\n  }\n\n  var msg;\n\n  if (endsWith(name, ' argument')) {\n    // For cases like 'first argument'\n    msg = \"The \".concat(name, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  } else {\n    var type = includes(name, '.') ? 'property' : 'argument';\n    msg = \"The \\\"\".concat(name, \"\\\" \").concat(type, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  }\n\n  msg += \". Received type \".concat(typeof actual);\n  return msg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_PUSH_AFTER_EOF', 'stream.push() after EOF');\ncreateErrorType('ERR_METHOD_NOT_IMPLEMENTED', function (name) {\n  return 'The ' + name + ' method is not implemented';\n});\ncreateErrorType('ERR_STREAM_PREMATURE_CLOSE', 'Premature close');\ncreateErrorType('ERR_STREAM_DESTROYED', function (name) {\n  return 'Cannot call ' + name + ' after a stream was destroyed';\n});\ncreateErrorType('ERR_MULTIPLE_CALLBACK', 'Callback called multiple times');\ncreateErrorType('ERR_STREAM_CANNOT_PIPE', 'Cannot pipe, not readable');\ncreateErrorType('ERR_STREAM_WRITE_AFTER_END', 'write after end');\ncreateErrorType('ERR_STREAM_NULL_VALUES', 'May not write null values to stream', TypeError);\ncreateErrorType('ERR_UNKNOWN_ENCODING', function (arg) {\n  return 'Unknown encoding: ' + arg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_UNSHIFT_AFTER_END_EVENT', 'stream.unshift() after end event');\nmodule.exports.codes = codes;\n","'use strict';\n\n/**\n * @typedef {{ [key: string]: any }} Extensions\n * @typedef {Error} Err\n * @property {string} message\n */\n\n/**\n *\n * @param {Error} obj\n * @param {Extensions} props\n * @returns {Error & Extensions}\n */\nfunction assign(obj, props) {\n    for (const key in props) {\n        Object.defineProperty(obj, key, {\n            value: props[key],\n            enumerable: true,\n            configurable: true,\n        });\n    }\n\n    return obj;\n}\n\n/**\n *\n * @param {any} err - An Error\n * @param {string|Extensions} code - A string code or props to set on the error\n * @param {Extensions} [props] - Props to set on the error\n * @returns {Error & Extensions}\n */\nfunction createError(err, code, props) {\n    if (!err || typeof err === 'string') {\n        throw new TypeError('Please pass an Error to err-code');\n    }\n\n    if (!props) {\n        props = {};\n    }\n\n    if (typeof code === 'object') {\n        props = code;\n        code = '';\n    }\n\n    if (code) {\n        props.code = code;\n    }\n\n    try {\n        return assign(err, props);\n    } catch (_) {\n        props.message = err.message;\n        props.stack = err.stack;\n\n        const ErrClass = function () {};\n\n        ErrClass.prototype = Object.create(Object.getPrototypeOf(err));\n\n        // @ts-ignore\n        const output = assign(new ErrClass(), props);\n\n        return output;\n    }\n}\n\nmodule.exports = createError;\n","// originally pulled out of simple-peer\n\nmodule.exports = function getBrowserRTC () {\n  if (typeof globalThis === 'undefined') return null\n  var wrtc = {\n    RTCPeerConnection: globalThis.RTCPeerConnection || globalThis.mozRTCPeerConnection ||\n      globalThis.webkitRTCPeerConnection,\n    RTCSessionDescription: globalThis.RTCSessionDescription ||\n      globalThis.mozRTCSessionDescription || globalThis.webkitRTCSessionDescription,\n    RTCIceCandidate: globalThis.RTCIceCandidate || globalThis.mozRTCIceCandidate ||\n      globalThis.webkitRTCIceCandidate\n  }\n  if (!wrtc.RTCPeerConnection) return null\n  return wrtc\n}\n","import SimplePeer from 'simple-peer';\n\n// Free Google STUN servers\nconst ICE_SERVERS = [\n  { urls: 'stun:stun.l.google.com:19302' },\n  { urls: 'stun:stun1.l.google.com:19302' },\n  { urls: 'stun:stun2.l.google.com:19302' },\n  { urls: 'stun:stun3.l.google.com:19302' },\n  { urls: 'stun:stun4.l.google.com:19302' },\n];\n\nexport interface SyncMessage {\n  type: 'sync' | 'play' | 'pause' | 'seek' | 'join' | 'ready' | 'error';\n  isPlaying?: boolean;\n  position?: number;\n  timestamp?: number;\n  userId?: string;\n  videoDuration?: number;\n  error?: string;\n}\n\nexport type ConnectionStatus =\n  | 'disconnected'\n  | 'connecting'\n  | 'connected'\n  | 'error';\n\nexport class P2PConnection {\n  private peer: SimplePeer.Instance | null = null;\n  private isHost: boolean;\n  private roomCode: string | null = null;\n  private onMessageCallback: ((message: SyncMessage) => void) | null = null;\n  private onStatusCallback: ((status: ConnectionStatus) => void) | null = null;\n  private connectedPeers: Map<string, SimplePeer.Instance> = new Map();\n\n  constructor(isHost: boolean) {\n    this.isHost = isHost;\n  }\n\n  /**\n   * Initialize connection as host\n   */\n  async initAsHost(): Promise<string> {\n    this.roomCode = this.generateRoomCode();\n    this.updateStatus('connecting');\n\n    return new Promise((resolve, reject) => {\n      try {\n        this.peer = new SimplePeer({\n          initiator: true,\n          trickle: false,\n          config: { iceServers: ICE_SERVERS },\n        });\n\n        this.setupPeerListeners(this.peer);\n\n        this.peer.on('signal', (signal) => {\n          // In a real implementation, you'd send this signal to a signaling server\n          // For now, we'll store it and let the user share it\n          const signalData = JSON.stringify(signal);\n          console.log('Host signal data:', signalData);\n          resolve(this.roomCode!);\n        });\n\n        this.peer.on('error', (err) => {\n          console.error('Peer error:', err);\n          this.updateStatus('error');\n          reject(err);\n        });\n      } catch (error) {\n        this.updateStatus('error');\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Join a room as guest\n   */\n  async joinRoom(roomCode: string, hostSignal: string): Promise<void> {\n    this.roomCode = roomCode;\n    this.updateStatus('connecting');\n\n    return new Promise((resolve, reject) => {\n      try {\n        this.peer = new SimplePeer({\n          initiator: false,\n          trickle: false,\n          config: { iceServers: ICE_SERVERS },\n        });\n\n        this.setupPeerListeners(this.peer);\n\n        this.peer.on('signal', (signal) => {\n          // Guest generates their signal and needs to send back to host\n          const signalData = JSON.stringify(signal);\n          console.log('Guest signal data:', signalData);\n        });\n\n        this.peer.on('connect', () => {\n          this.updateStatus('connected');\n          resolve();\n        });\n\n        this.peer.on('error', (err) => {\n          console.error('Peer error:', err);\n          this.updateStatus('error');\n          reject(err);\n        });\n\n        // Signal the host\n        const parsedSignal = JSON.parse(hostSignal);\n        this.peer.signal(parsedSignal);\n      } catch (error) {\n        this.updateStatus('error');\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Complete connection with guest signal (host only)\n   */\n  async connectWithGuest(guestSignal: string): Promise<void> {\n    if (!this.isHost || !this.peer) {\n      throw new Error('Only host can accept guest connections');\n    }\n\n    try {\n      const parsedSignal = JSON.parse(guestSignal);\n      this.peer.signal(parsedSignal);\n      this.updateStatus('connected');\n    } catch (error) {\n      console.error('Error connecting with guest:', error);\n      this.updateStatus('error');\n      throw error;\n    }\n  }\n\n  /**\n   * Setup peer event listeners\n   */\n  private setupPeerListeners(peer: SimplePeer.Instance): void {\n    peer.on('connect', () => {\n      console.log('Peer connected');\n      this.updateStatus('connected');\n    });\n\n    peer.on('data', (data) => {\n      try {\n        const message: SyncMessage = JSON.parse(data.toString());\n        console.log('Received message:', message);\n        if (this.onMessageCallback) {\n          this.onMessageCallback(message);\n        }\n      } catch (error) {\n        console.error('Error parsing message:', error);\n      }\n    });\n\n    peer.on('close', () => {\n      console.log('Peer connection closed');\n      this.updateStatus('disconnected');\n    });\n\n    peer.on('error', (err) => {\n      console.error('Peer error:', err);\n      this.updateStatus('error');\n    });\n  }\n\n  /**\n   * Send message to connected peer(s)\n   */\n  sendMessage(message: SyncMessage): void {\n    if (!this.peer || this.peer.destroyed) {\n      console.warn('Cannot send message: peer not connected');\n      return;\n    }\n\n    try {\n      const data = JSON.stringify(message);\n      this.peer.send(data);\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  }\n\n  /**\n   * Broadcast message to all connected peers (host only)\n   */\n  broadcast(message: SyncMessage): void {\n    if (!this.isHost) {\n      console.warn('Only host can broadcast');\n      return;\n    }\n\n    this.sendMessage(message);\n\n    // Also send to all other connected peers\n    this.connectedPeers.forEach((peer) => {\n      if (!peer.destroyed) {\n        try {\n          peer.send(JSON.stringify(message));\n        } catch (error) {\n          console.error('Error broadcasting to peer:', error);\n        }\n      }\n    });\n  }\n\n  /**\n   * Set callback for incoming messages\n   */\n  onMessage(callback: (message: SyncMessage) => void): void {\n    this.onMessageCallback = callback;\n  }\n\n  /**\n   * Set callback for status changes\n   */\n  onStatusChange(callback: (status: ConnectionStatus) => void): void {\n    this.onStatusCallback = callback;\n  }\n\n  /**\n   * Update connection status\n   */\n  private updateStatus(status: ConnectionStatus): void {\n    if (this.onStatusCallback) {\n      this.onStatusCallback(status);\n    }\n  }\n\n  /**\n   * Generate a random room code\n   */\n  private generateRoomCode(): string {\n    const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';\n    let code = '';\n    for (let i = 0; i < 6; i++) {\n      code += chars.charAt(Math.floor(Math.random() * chars.length));\n    }\n    return code;\n  }\n\n  /**\n   * Get the room code\n   */\n  getRoomCode(): string | null {\n    return this.roomCode;\n  }\n\n  /**\n   * Get host signal for sharing\n   */\n  getSignalData(): Promise<string> {\n    return new Promise((resolve, reject) => {\n      if (!this.peer) {\n        reject(new Error('Peer not initialized'));\n        return;\n      }\n\n      const timeout = setTimeout(() => {\n        reject(new Error('Signal generation timeout'));\n      }, 10000);\n\n      this.peer.on('signal', (signal) => {\n        clearTimeout(timeout);\n        resolve(JSON.stringify(signal));\n      });\n    });\n  }\n\n  /**\n   * Check if connected\n   */\n  isConnected(): boolean {\n    return this.peer !== null && !this.peer.destroyed;\n  }\n\n  /**\n   * Disconnect and cleanup\n   */\n  disconnect(): void {\n    if (this.peer) {\n      this.peer.destroy();\n      this.peer = null;\n    }\n\n    this.connectedPeers.forEach((peer) => {\n      peer.destroy();\n    });\n    this.connectedPeers.clear();\n\n    this.updateStatus('disconnected');\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\n/*</replacement>*/\n\nvar isEncoding = Buffer.isEncoding || function (encoding) {\n  encoding = '' + encoding;\n  switch (encoding && encoding.toLowerCase()) {\n    case 'hex':case 'utf8':case 'utf-8':case 'ascii':case 'binary':case 'base64':case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':case 'raw':\n      return true;\n    default:\n      return false;\n  }\n};\n\nfunction _normalizeEncoding(enc) {\n  if (!enc) return 'utf8';\n  var retried;\n  while (true) {\n    switch (enc) {\n      case 'utf8':\n      case 'utf-8':\n        return 'utf8';\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return 'utf16le';\n      case 'latin1':\n      case 'binary':\n        return 'latin1';\n      case 'base64':\n      case 'ascii':\n      case 'hex':\n        return enc;\n      default:\n        if (retried) return; // undefined\n        enc = ('' + enc).toLowerCase();\n        retried = true;\n    }\n  }\n};\n\n// Do not cache `Buffer.isEncoding` when checking encoding names as some\n// modules monkey-patch it to support additional encodings\nfunction normalizeEncoding(enc) {\n  var nenc = _normalizeEncoding(enc);\n  if (typeof nenc !== 'string' && (Buffer.isEncoding === isEncoding || !isEncoding(enc))) throw new Error('Unknown encoding: ' + enc);\n  return nenc || enc;\n}\n\n// StringDecoder provides an interface for efficiently splitting a series of\n// buffers into a series of JS strings without breaking apart multi-byte\n// characters.\nexports.StringDecoder = StringDecoder;\nfunction StringDecoder(encoding) {\n  this.encoding = normalizeEncoding(encoding);\n  var nb;\n  switch (this.encoding) {\n    case 'utf16le':\n      this.text = utf16Text;\n      this.end = utf16End;\n      nb = 4;\n      break;\n    case 'utf8':\n      this.fillLast = utf8FillLast;\n      nb = 4;\n      break;\n    case 'base64':\n      this.text = base64Text;\n      this.end = base64End;\n      nb = 3;\n      break;\n    default:\n      this.write = simpleWrite;\n      this.end = simpleEnd;\n      return;\n  }\n  this.lastNeed = 0;\n  this.lastTotal = 0;\n  this.lastChar = Buffer.allocUnsafe(nb);\n}\n\nStringDecoder.prototype.write = function (buf) {\n  if (buf.length === 0) return '';\n  var r;\n  var i;\n  if (this.lastNeed) {\n    r = this.fillLast(buf);\n    if (r === undefined) return '';\n    i = this.lastNeed;\n    this.lastNeed = 0;\n  } else {\n    i = 0;\n  }\n  if (i < buf.length) return r ? r + this.text(buf, i) : this.text(buf, i);\n  return r || '';\n};\n\nStringDecoder.prototype.end = utf8End;\n\n// Returns only complete characters in a Buffer\nStringDecoder.prototype.text = utf8Text;\n\n// Attempts to complete a partial non-UTF-8 character using bytes from a Buffer\nStringDecoder.prototype.fillLast = function (buf) {\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, buf.length);\n  this.lastNeed -= buf.length;\n};\n\n// Checks the type of a UTF-8 byte, whether it's ASCII, a leading byte, or a\n// continuation byte. If an invalid byte is detected, -2 is returned.\nfunction utf8CheckByte(byte) {\n  if (byte <= 0x7F) return 0;else if (byte >> 5 === 0x06) return 2;else if (byte >> 4 === 0x0E) return 3;else if (byte >> 3 === 0x1E) return 4;\n  return byte >> 6 === 0x02 ? -1 : -2;\n}\n\n// Checks at most 3 bytes at the end of a Buffer in order to detect an\n// incomplete multi-byte UTF-8 character. The total number of bytes (2, 3, or 4)\n// needed to complete the UTF-8 character (if applicable) are returned.\nfunction utf8CheckIncomplete(self, buf, i) {\n  var j = buf.length - 1;\n  if (j < i) return 0;\n  var nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 1;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 2;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) {\n      if (nb === 2) nb = 0;else self.lastNeed = nb - 3;\n    }\n    return nb;\n  }\n  return 0;\n}\n\n// Validates as many continuation bytes for a multi-byte UTF-8 character as\n// needed or are available. If we see a non-continuation byte where we expect\n// one, we \"replace\" the validated continuation bytes we've seen so far with\n// a single UTF-8 replacement character ('\\ufffd'), to match v8's UTF-8 decoding\n// behavior. The continuation byte check is included three times in the case\n// where all of the continuation bytes for a character exist in the same buffer.\n// It is also done this way as a slight performance increase instead of using a\n// loop.\nfunction utf8CheckExtraBytes(self, buf, p) {\n  if ((buf[0] & 0xC0) !== 0x80) {\n    self.lastNeed = 0;\n    return '\\ufffd';\n  }\n  if (self.lastNeed > 1 && buf.length > 1) {\n    if ((buf[1] & 0xC0) !== 0x80) {\n      self.lastNeed = 1;\n      return '\\ufffd';\n    }\n    if (self.lastNeed > 2 && buf.length > 2) {\n      if ((buf[2] & 0xC0) !== 0x80) {\n        self.lastNeed = 2;\n        return '\\ufffd';\n      }\n    }\n  }\n}\n\n// Attempts to complete a multi-byte UTF-8 character using bytes from a Buffer.\nfunction utf8FillLast(buf) {\n  var p = this.lastTotal - this.lastNeed;\n  var r = utf8CheckExtraBytes(this, buf, p);\n  if (r !== undefined) return r;\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, p, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, p, 0, buf.length);\n  this.lastNeed -= buf.length;\n}\n\n// Returns all complete UTF-8 characters in a Buffer. If the Buffer ended on a\n// partial character, the character's bytes are buffered until the required\n// number of bytes are available.\nfunction utf8Text(buf, i) {\n  var total = utf8CheckIncomplete(this, buf, i);\n  if (!this.lastNeed) return buf.toString('utf8', i);\n  this.lastTotal = total;\n  var end = buf.length - (total - this.lastNeed);\n  buf.copy(this.lastChar, 0, end);\n  return buf.toString('utf8', i, end);\n}\n\n// For UTF-8, a replacement character is added when ending on a partial\n// character.\nfunction utf8End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + '\\ufffd';\n  return r;\n}\n\n// UTF-16LE typically needs two bytes per character, but even if we have an even\n// number of bytes available, we need to check if we end on a leading/high\n// surrogate. In that case, we need to wait for the next two bytes in order to\n// decode the last character properly.\nfunction utf16Text(buf, i) {\n  if ((buf.length - i) % 2 === 0) {\n    var r = buf.toString('utf16le', i);\n    if (r) {\n      var c = r.charCodeAt(r.length - 1);\n      if (c >= 0xD800 && c <= 0xDBFF) {\n        this.lastNeed = 2;\n        this.lastTotal = 4;\n        this.lastChar[0] = buf[buf.length - 2];\n        this.lastChar[1] = buf[buf.length - 1];\n        return r.slice(0, -1);\n      }\n    }\n    return r;\n  }\n  this.lastNeed = 1;\n  this.lastTotal = 2;\n  this.lastChar[0] = buf[buf.length - 1];\n  return buf.toString('utf16le', i, buf.length - 1);\n}\n\n// For UTF-16LE we do not explicitly append special replacement characters if we\n// end on a partial character, we simply let v8 handle that.\nfunction utf16End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) {\n    var end = this.lastTotal - this.lastNeed;\n    return r + this.lastChar.toString('utf16le', 0, end);\n  }\n  return r;\n}\n\nfunction base64Text(buf, i) {\n  var n = (buf.length - i) % 3;\n  if (n === 0) return buf.toString('base64', i);\n  this.lastNeed = 3 - n;\n  this.lastTotal = 3;\n  if (n === 1) {\n    this.lastChar[0] = buf[buf.length - 1];\n  } else {\n    this.lastChar[0] = buf[buf.length - 2];\n    this.lastChar[1] = buf[buf.length - 1];\n  }\n  return buf.toString('base64', i, buf.length - n);\n}\n\nfunction base64End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + this.lastChar.toString('base64', 0, 3 - this.lastNeed);\n  return r;\n}\n\n// Pass bytes on through for single-byte encodings (e.g. ascii, latin1, hex)\nfunction simpleWrite(buf) {\n  return buf.toString(this.encoding);\n}\n\nfunction simpleEnd(buf) {\n  return buf && buf.length ? this.write(buf) : '';\n}","module.exports = function () {\n  throw new Error('Readable.from is not available in the browser')\n};\n","module.exports = require(\"buffer\");","'use strict'\n\n// limit of Crypto.getRandomValues()\n// https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues\nvar MAX_BYTES = 65536\n\n// Node supports requesting up to this number of bytes\n// https://github.com/nodejs/node/blob/master/lib/internal/crypto/random.js#L48\nvar MAX_UINT32 = 4294967295\n\nfunction oldBrowser () {\n  throw new Error('Secure random number generation is not supported by this browser.\\nUse Chrome, Firefox or Internet Explorer 11')\n}\n\nvar Buffer = require('safe-buffer').Buffer\nvar crypto = global.crypto || global.msCrypto\n\nif (crypto && crypto.getRandomValues) {\n  module.exports = randomBytes\n} else {\n  module.exports = oldBrowser\n}\n\nfunction randomBytes (size, cb) {\n  // phantomjs needs to throw\n  if (size > MAX_UINT32) throw new RangeError('requested too many random bytes')\n\n  var bytes = Buffer.allocUnsafe(size)\n\n  if (size > 0) {  // getRandomValues fails on IE if size == 0\n    if (size > MAX_BYTES) { // this is the max bytes crypto.getRandomValues\n      // can do at once see https://developer.mozilla.org/en-US/docs/Web/API/window.crypto.getRandomValues\n      for (var generated = 0; generated < size; generated += MAX_BYTES) {\n        // buffer.slice automatically checks if the end is past the end of\n        // the buffer so we don't have to here\n        crypto.getRandomValues(bytes.slice(generated, generated + MAX_BYTES))\n      }\n    } else {\n      crypto.getRandomValues(bytes)\n    }\n  }\n\n  if (typeof cb === 'function') {\n    return process.nextTick(function () {\n      cb(null, bytes)\n    })\n  }\n\n  return bytes\n}\n","// Ported from https://github.com/mafintosh/end-of-stream with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar ERR_STREAM_PREMATURE_CLOSE = require('../../../errors').codes.ERR_STREAM_PREMATURE_CLOSE;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    callback.apply(this, args);\n  };\n}\nfunction noop() {}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction eos(stream, opts, callback) {\n  if (typeof opts === 'function') return eos(stream, null, opts);\n  if (!opts) opts = {};\n  callback = once(callback || noop);\n  var readable = opts.readable || opts.readable !== false && stream.readable;\n  var writable = opts.writable || opts.writable !== false && stream.writable;\n  var onlegacyfinish = function onlegacyfinish() {\n    if (!stream.writable) onfinish();\n  };\n  var writableEnded = stream._writableState && stream._writableState.finished;\n  var onfinish = function onfinish() {\n    writable = false;\n    writableEnded = true;\n    if (!readable) callback.call(stream);\n  };\n  var readableEnded = stream._readableState && stream._readableState.endEmitted;\n  var onend = function onend() {\n    readable = false;\n    readableEnded = true;\n    if (!writable) callback.call(stream);\n  };\n  var onerror = function onerror(err) {\n    callback.call(stream, err);\n  };\n  var onclose = function onclose() {\n    var err;\n    if (readable && !readableEnded) {\n      if (!stream._readableState || !stream._readableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n    if (writable && !writableEnded) {\n      if (!stream._writableState || !stream._writableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n  };\n  var onrequest = function onrequest() {\n    stream.req.on('finish', onfinish);\n  };\n  if (isRequest(stream)) {\n    stream.on('complete', onfinish);\n    stream.on('abort', onclose);\n    if (stream.req) onrequest();else stream.on('request', onrequest);\n  } else if (writable && !stream._writableState) {\n    // legacy streams\n    stream.on('end', onlegacyfinish);\n    stream.on('close', onlegacyfinish);\n  }\n  stream.on('end', onend);\n  stream.on('finish', onfinish);\n  if (opts.error !== false) stream.on('error', onerror);\n  stream.on('close', onclose);\n  return function () {\n    stream.removeListener('complete', onfinish);\n    stream.removeListener('abort', onclose);\n    stream.removeListener('request', onrequest);\n    if (stream.req) stream.req.removeListener('finish', onfinish);\n    stream.removeListener('end', onlegacyfinish);\n    stream.removeListener('close', onlegacyfinish);\n    stream.removeListener('finish', onfinish);\n    stream.removeListener('end', onend);\n    stream.removeListener('error', onerror);\n    stream.removeListener('close', onclose);\n  };\n}\nmodule.exports = eos;","'use strict';\n\nvar ERR_INVALID_OPT_VALUE = require('../../../errors').codes.ERR_INVALID_OPT_VALUE;\nfunction highWaterMarkFrom(options, isDuplex, duplexKey) {\n  return options.highWaterMark != null ? options.highWaterMark : isDuplex ? options[duplexKey] : null;\n}\nfunction getHighWaterMark(state, options, duplexKey, isDuplex) {\n  var hwm = highWaterMarkFrom(options, isDuplex, duplexKey);\n  if (hwm != null) {\n    if (!(isFinite(hwm) && Math.floor(hwm) === hwm) || hwm < 0) {\n      var name = isDuplex ? duplexKey : 'highWaterMark';\n      throw new ERR_INVALID_OPT_VALUE(name, hwm);\n    }\n    return Math.floor(hwm);\n  }\n\n  // Default value\n  return state.objectMode ? 16 : 16 * 1024;\n}\nmodule.exports = {\n  getHighWaterMark: getHighWaterMark\n};","module.exports = require('events').EventEmitter;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\n'use strict';\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n};\n/*</replacement>*/\n\nmodule.exports = Duplex;\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\nrequire('inherits')(Duplex, Readable);\n{\n  // Allow the keys array to be GC'ed.\n  var keys = objectKeys(Writable.prototype);\n  for (var v = 0; v < keys.length; v++) {\n    var method = keys[v];\n    if (!Duplex.prototype[method]) Duplex.prototype[method] = Writable.prototype[method];\n  }\n}\nfunction Duplex(options) {\n  if (!(this instanceof Duplex)) return new Duplex(options);\n  Readable.call(this, options);\n  Writable.call(this, options);\n  this.allowHalfOpen = true;\n  if (options) {\n    if (options.readable === false) this.readable = false;\n    if (options.writable === false) this.writable = false;\n    if (options.allowHalfOpen === false) {\n      this.allowHalfOpen = false;\n      this.once('end', onend);\n    }\n  }\n}\nObject.defineProperty(Duplex.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\n\n// the no-half-open enforcer\nfunction onend() {\n  // If the writable side ended, then we're ok.\n  if (this._writableState.ended) return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  process.nextTick(onEndNT, this);\n}\nfunction onEndNT(self) {\n  self.end();\n}\nObject.defineProperty(Duplex.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed && this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n    this._writableState.destroyed = value;\n  }\n});","exports = module.exports = require('./lib/_stream_readable.js');\nexports.Stream = exports;\nexports.Readable = exports;\nexports.Writable = require('./lib/_stream_writable.js');\nexports.Duplex = require('./lib/_stream_duplex.js');\nexports.Transform = require('./lib/_stream_transform.js');\nexports.PassThrough = require('./lib/_stream_passthrough.js');\nexports.finished = require('./lib/internal/streams/end-of-stream.js');\nexports.pipeline = require('./lib/internal/streams/pipeline.js');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\n/*<replacement>*/\nvar EE = require('events').EventEmitter;\nvar EElistenerCount = function EElistenerCount(emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*<replacement>*/\nvar debugUtil = require('util');\nvar debug;\nif (debugUtil && debugUtil.debuglog) {\n  debug = debugUtil.debuglog('stream');\n} else {\n  debug = function debug() {};\n}\n/*</replacement>*/\n\nvar BufferList = require('./internal/streams/buffer_list');\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_STREAM_PUSH_AFTER_EOF = _require$codes.ERR_STREAM_PUSH_AFTER_EOF,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_STREAM_UNSHIFT_AFTER_END_EVENT = _require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;\n\n// Lazy loaded to improve the startup performance.\nvar StringDecoder;\nvar createReadableStreamAsyncIterator;\nvar from;\nrequire('inherits')(Readable, Stream);\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nvar kProxyEvents = ['error', 'close', 'destroy', 'pause', 'resume'];\nfunction prependListener(emitter, event, fn) {\n  // Sadly this is not cacheable as some libraries bundle their own\n  // event emitter implementation with them.\n  if (typeof emitter.prependListener === 'function') return emitter.prependListener(event, fn);\n\n  // This is a hack to make sure that our error handler is attached before any\n  // userland ones.  NEVER DO THIS. This is here only because this code needs\n  // to continue to work with older versions of Node.js that do not include\n  // the prependListener() method. The goal is to eventually remove this hack.\n  if (!emitter._events || !emitter._events[event]) emitter.on(event, fn);else if (Array.isArray(emitter._events[event])) emitter._events[event].unshift(fn);else emitter._events[event] = [fn, emitter._events[event]];\n}\nfunction ReadableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.readableObjectMode;\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  this.highWaterMark = getHighWaterMark(this, options, 'readableHighWaterMark', isDuplex);\n\n  // A linked list is used to store data chunks instead of an array because the\n  // linked list can remove elements from the beginning faster than\n  // array.shift()\n  this.buffer = new BufferList();\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = null;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // a flag to be able to tell if the event 'readable'/'data' is emitted\n  // immediately, or on a later tick.  We set this to true at first, because\n  // any actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first read call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n  this.resumeScheduled = false;\n  this.paused = true;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'end' (and potentially 'finish')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\nfunction Readable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n  if (!(this instanceof Readable)) return new Readable(options);\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the ReadableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  this._readableState = new ReadableState(options, this, isDuplex);\n\n  // legacy\n  this.readable = true;\n  if (options) {\n    if (typeof options.read === 'function') this._read = options.read;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n  }\n  Stream.call(this);\n}\nObject.defineProperty(Readable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._readableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n  }\n});\nReadable.prototype.destroy = destroyImpl.destroy;\nReadable.prototype._undestroy = destroyImpl.undestroy;\nReadable.prototype._destroy = function (err, cb) {\n  cb(err);\n};\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function (chunk, encoding) {\n  var state = this._readableState;\n  var skipChunkCheck;\n  if (!state.objectMode) {\n    if (typeof chunk === 'string') {\n      encoding = encoding || state.defaultEncoding;\n      if (encoding !== state.encoding) {\n        chunk = Buffer.from(chunk, encoding);\n        encoding = '';\n      }\n      skipChunkCheck = true;\n    }\n  } else {\n    skipChunkCheck = true;\n  }\n  return readableAddChunk(this, chunk, encoding, false, skipChunkCheck);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function (chunk) {\n  return readableAddChunk(this, chunk, null, true, false);\n};\nfunction readableAddChunk(stream, chunk, encoding, addToFront, skipChunkCheck) {\n  debug('readableAddChunk', chunk);\n  var state = stream._readableState;\n  if (chunk === null) {\n    state.reading = false;\n    onEofChunk(stream, state);\n  } else {\n    var er;\n    if (!skipChunkCheck) er = chunkInvalid(state, chunk);\n    if (er) {\n      errorOrDestroy(stream, er);\n    } else if (state.objectMode || chunk && chunk.length > 0) {\n      if (typeof chunk !== 'string' && !state.objectMode && Object.getPrototypeOf(chunk) !== Buffer.prototype) {\n        chunk = _uint8ArrayToBuffer(chunk);\n      }\n      if (addToFront) {\n        if (state.endEmitted) errorOrDestroy(stream, new ERR_STREAM_UNSHIFT_AFTER_END_EVENT());else addChunk(stream, state, chunk, true);\n      } else if (state.ended) {\n        errorOrDestroy(stream, new ERR_STREAM_PUSH_AFTER_EOF());\n      } else if (state.destroyed) {\n        return false;\n      } else {\n        state.reading = false;\n        if (state.decoder && !encoding) {\n          chunk = state.decoder.write(chunk);\n          if (state.objectMode || chunk.length !== 0) addChunk(stream, state, chunk, false);else maybeReadMore(stream, state);\n        } else {\n          addChunk(stream, state, chunk, false);\n        }\n      }\n    } else if (!addToFront) {\n      state.reading = false;\n      maybeReadMore(stream, state);\n    }\n  }\n\n  // We can push more data if we are below the highWaterMark.\n  // Also, if we have no data yet, we can stand some more bytes.\n  // This is to work around cases where hwm=0, such as the repl.\n  return !state.ended && (state.length < state.highWaterMark || state.length === 0);\n}\nfunction addChunk(stream, state, chunk, addToFront) {\n  if (state.flowing && state.length === 0 && !state.sync) {\n    state.awaitDrain = 0;\n    stream.emit('data', chunk);\n  } else {\n    // update the buffer info.\n    state.length += state.objectMode ? 1 : chunk.length;\n    if (addToFront) state.buffer.unshift(chunk);else state.buffer.push(chunk);\n    if (state.needReadable) emitReadable(stream);\n  }\n  maybeReadMore(stream, state);\n}\nfunction chunkInvalid(state, chunk) {\n  var er;\n  if (!_isUint8Array(chunk) && typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer', 'Uint8Array'], chunk);\n  }\n  return er;\n}\nReadable.prototype.isPaused = function () {\n  return this._readableState.flowing === false;\n};\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function (enc) {\n  if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n  var decoder = new StringDecoder(enc);\n  this._readableState.decoder = decoder;\n  // If setEncoding(null), decoder.encoding equals utf8\n  this._readableState.encoding = this._readableState.decoder.encoding;\n\n  // Iterate over current buffer to convert already stored Buffers:\n  var p = this._readableState.buffer.head;\n  var content = '';\n  while (p !== null) {\n    content += decoder.write(p.data);\n    p = p.next;\n  }\n  this._readableState.buffer.clear();\n  if (content !== '') this._readableState.buffer.push(content);\n  this._readableState.length = content.length;\n  return this;\n};\n\n// Don't raise the hwm > 1GB\nvar MAX_HWM = 0x40000000;\nfunction computeNewHighWaterMark(n) {\n  if (n >= MAX_HWM) {\n    // TODO(ronag): Throw ERR_VALUE_OUT_OF_RANGE.\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2 to prevent increasing hwm excessively in\n    // tiny amounts\n    n--;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    n++;\n  }\n  return n;\n}\n\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction howMuchToRead(n, state) {\n  if (n <= 0 || state.length === 0 && state.ended) return 0;\n  if (state.objectMode) return 1;\n  if (n !== n) {\n    // Only flow one buffer at a time\n    if (state.flowing && state.length) return state.buffer.head.data.length;else return state.length;\n  }\n  // If we're asking for more than the current hwm, then raise the hwm.\n  if (n > state.highWaterMark) state.highWaterMark = computeNewHighWaterMark(n);\n  if (n <= state.length) return n;\n  // Don't have enough\n  if (!state.ended) {\n    state.needReadable = true;\n    return 0;\n  }\n  return state.length;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function (n) {\n  debug('read', n);\n  n = parseInt(n, 10);\n  var state = this._readableState;\n  var nOrig = n;\n  if (n !== 0) state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 && state.needReadable && ((state.highWaterMark !== 0 ? state.length >= state.highWaterMark : state.length > 0) || state.ended)) {\n    debug('read: emitReadable', state.length, state.ended);\n    if (state.length === 0 && state.ended) endReadable(this);else emitReadable(this);\n    return null;\n  }\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    if (state.length === 0) endReadable(this);\n    return null;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n  debug('need readable', doRead);\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length === 0 || state.length - n < state.highWaterMark) {\n    doRead = true;\n    debug('length less than watermark', doRead);\n  }\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading) {\n    doRead = false;\n    debug('reading or ended', doRead);\n  } else if (doRead) {\n    debug('do read');\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0) state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n    // If _read pushed data synchronously, then `reading` will be false,\n    // and we need to re-evaluate how much data we can return to the user.\n    if (!state.reading) n = howMuchToRead(nOrig, state);\n  }\n  var ret;\n  if (n > 0) ret = fromList(n, state);else ret = null;\n  if (ret === null) {\n    state.needReadable = state.length <= state.highWaterMark;\n    n = 0;\n  } else {\n    state.length -= n;\n    state.awaitDrain = 0;\n  }\n  if (state.length === 0) {\n    // If we have nothing in the buffer, then we want to know\n    // as soon as we *do* get something into the buffer.\n    if (!state.ended) state.needReadable = true;\n\n    // If we tried to read() past the EOF, then emit end on the next tick.\n    if (nOrig !== n && state.ended) endReadable(this);\n  }\n  if (ret !== null) this.emit('data', ret);\n  return ret;\n};\nfunction onEofChunk(stream, state) {\n  debug('onEofChunk');\n  if (state.ended) return;\n  if (state.decoder) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n  if (state.sync) {\n    // if we are sync, wait until next tick to emit the data.\n    // Otherwise we risk emitting data in the flow()\n    // the readable code triggers during a read() call\n    emitReadable(stream);\n  } else {\n    // emit 'readable' now to make sure it gets picked up.\n    state.needReadable = false;\n    if (!state.emittedReadable) {\n      state.emittedReadable = true;\n      emitReadable_(stream);\n    }\n  }\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  debug('emitReadable', state.needReadable, state.emittedReadable);\n  state.needReadable = false;\n  if (!state.emittedReadable) {\n    debug('emitReadable', state.flowing);\n    state.emittedReadable = true;\n    process.nextTick(emitReadable_, stream);\n  }\n}\nfunction emitReadable_(stream) {\n  var state = stream._readableState;\n  debug('emitReadable_', state.destroyed, state.length, state.ended);\n  if (!state.destroyed && (state.length || state.ended)) {\n    stream.emit('readable');\n    state.emittedReadable = false;\n  }\n\n  // The stream needs another readable event if\n  // 1. It is not flowing, as the flow mechanism will take\n  //    care of it.\n  // 2. It is not ended.\n  // 3. It is below the highWaterMark, so we can schedule\n  //    another readable later.\n  state.needReadable = !state.flowing && !state.ended && state.length <= state.highWaterMark;\n  flow(stream);\n}\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    process.nextTick(maybeReadMore_, stream, state);\n  }\n}\nfunction maybeReadMore_(stream, state) {\n  // Attempt to read more data if we should.\n  //\n  // The conditions for reading more data are (one of):\n  // - Not enough data buffered (state.length < state.highWaterMark). The loop\n  //   is responsible for filling the buffer with enough data if such data\n  //   is available. If highWaterMark is 0 and we are not in the flowing mode\n  //   we should _not_ attempt to buffer any extra data. We'll get more data\n  //   when the stream consumer calls read() instead.\n  // - No data in the buffer, and the stream is in flowing mode. In this mode\n  //   the loop below is responsible for ensuring read() is called. Failing to\n  //   call read here would abort the flow and there's no other mechanism for\n  //   continuing the flow if the stream consumer has just subscribed to the\n  //   'data' event.\n  //\n  // In addition to the above conditions to keep reading data, the following\n  // conditions prevent the data from being read:\n  // - The stream has ended (state.ended).\n  // - There is already a pending 'read' operation (state.reading). This is a\n  //   case where the the stream has called the implementation defined _read()\n  //   method, but they are processing the call asynchronously and have _not_\n  //   called push() with new data. In this case we skip performing more\n  //   read()s. The execution ends in this method again after the _read() ends\n  //   up calling push() with more data.\n  while (!state.reading && !state.ended && (state.length < state.highWaterMark || state.flowing && state.length === 0)) {\n    var len = state.length;\n    debug('maybeReadMore read 0');\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function (n) {\n  errorOrDestroy(this, new ERR_METHOD_NOT_IMPLEMENTED('_read()'));\n};\nReadable.prototype.pipe = function (dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n  debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n  var endFn = doEnd ? onend : unpipe;\n  if (state.endEmitted) process.nextTick(endFn);else src.once('end', endFn);\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable, unpipeInfo) {\n    debug('onunpipe');\n    if (readable === src) {\n      if (unpipeInfo && unpipeInfo.hasUnpiped === false) {\n        unpipeInfo.hasUnpiped = true;\n        cleanup();\n      }\n    }\n  }\n  function onend() {\n    debug('onend');\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n  var cleanedUp = false;\n  function cleanup() {\n    debug('cleanup');\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', unpipe);\n    src.removeListener('data', ondata);\n    cleanedUp = true;\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain)) ondrain();\n  }\n  src.on('data', ondata);\n  function ondata(chunk) {\n    debug('ondata');\n    var ret = dest.write(chunk);\n    debug('dest.write', ret);\n    if (ret === false) {\n      // If the user unpiped during `dest.write()`, it is possible\n      // to get stuck in a permanently paused state if that write\n      // also returned false.\n      // => Check whether `dest` is still a piping destination.\n      if ((state.pipesCount === 1 && state.pipes === dest || state.pipesCount > 1 && indexOf(state.pipes, dest) !== -1) && !cleanedUp) {\n        debug('false write response, pause', state.awaitDrain);\n        state.awaitDrain++;\n      }\n      src.pause();\n    }\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    debug('onerror', er);\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EElistenerCount(dest, 'error') === 0) errorOrDestroy(dest, er);\n  }\n\n  // Make sure our error handler is attached before userland ones.\n  prependListener(dest, 'error', onerror);\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    debug('onfinish');\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n  function unpipe() {\n    debug('unpipe');\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    debug('pipe resume');\n    src.resume();\n  }\n  return dest;\n};\nfunction pipeOnDrain(src) {\n  return function pipeOnDrainFunctionResult() {\n    var state = src._readableState;\n    debug('pipeOnDrain', state.awaitDrain);\n    if (state.awaitDrain) state.awaitDrain--;\n    if (state.awaitDrain === 0 && EElistenerCount(src, 'data')) {\n      state.flowing = true;\n      flow(src);\n    }\n  };\n}\nReadable.prototype.unpipe = function (dest) {\n  var state = this._readableState;\n  var unpipeInfo = {\n    hasUnpiped: false\n  };\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0) return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes) return this;\n    if (!dest) dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    if (dest) dest.emit('unpipe', this, unpipeInfo);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    for (var i = 0; i < len; i++) dests[i].emit('unpipe', this, {\n      hasUnpiped: false\n    });\n    return this;\n  }\n\n  // try to find the right one.\n  var index = indexOf(state.pipes, dest);\n  if (index === -1) return this;\n  state.pipes.splice(index, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1) state.pipes = state.pipes[0];\n  dest.emit('unpipe', this, unpipeInfo);\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function (ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n  var state = this._readableState;\n  if (ev === 'data') {\n    // update readableListening so that resume() may be a no-op\n    // a few lines down. This is needed to support once('readable').\n    state.readableListening = this.listenerCount('readable') > 0;\n\n    // Try start flowing on next tick if stream isn't explicitly paused\n    if (state.flowing !== false) this.resume();\n  } else if (ev === 'readable') {\n    if (!state.endEmitted && !state.readableListening) {\n      state.readableListening = state.needReadable = true;\n      state.flowing = false;\n      state.emittedReadable = false;\n      debug('on readable', state.length, state.reading);\n      if (state.length) {\n        emitReadable(this);\n      } else if (!state.reading) {\n        process.nextTick(nReadingNextTick, this);\n      }\n    }\n  }\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\nReadable.prototype.removeListener = function (ev, fn) {\n  var res = Stream.prototype.removeListener.call(this, ev, fn);\n  if (ev === 'readable') {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nReadable.prototype.removeAllListeners = function (ev) {\n  var res = Stream.prototype.removeAllListeners.apply(this, arguments);\n  if (ev === 'readable' || ev === undefined) {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nfunction updateReadableListening(self) {\n  var state = self._readableState;\n  state.readableListening = self.listenerCount('readable') > 0;\n  if (state.resumeScheduled && !state.paused) {\n    // flowing needs to be set to true now, otherwise\n    // the upcoming resume will not flow.\n    state.flowing = true;\n\n    // crude way to check if we should resume\n  } else if (self.listenerCount('data') > 0) {\n    self.resume();\n  }\n}\nfunction nReadingNextTick(self) {\n  debug('readable nexttick read 0');\n  self.read(0);\n}\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function () {\n  var state = this._readableState;\n  if (!state.flowing) {\n    debug('resume');\n    // we flow only if there is no one listening\n    // for readable, but we still have to call\n    // resume()\n    state.flowing = !state.readableListening;\n    resume(this, state);\n  }\n  state.paused = false;\n  return this;\n};\nfunction resume(stream, state) {\n  if (!state.resumeScheduled) {\n    state.resumeScheduled = true;\n    process.nextTick(resume_, stream, state);\n  }\n}\nfunction resume_(stream, state) {\n  debug('resume', state.reading);\n  if (!state.reading) {\n    stream.read(0);\n  }\n  state.resumeScheduled = false;\n  stream.emit('resume');\n  flow(stream);\n  if (state.flowing && !state.reading) stream.read(0);\n}\nReadable.prototype.pause = function () {\n  debug('call pause flowing=%j', this._readableState.flowing);\n  if (this._readableState.flowing !== false) {\n    debug('pause');\n    this._readableState.flowing = false;\n    this.emit('pause');\n  }\n  this._readableState.paused = true;\n  return this;\n};\nfunction flow(stream) {\n  var state = stream._readableState;\n  debug('flow', state.flowing);\n  while (state.flowing && stream.read() !== null);\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function (stream) {\n  var _this = this;\n  var state = this._readableState;\n  var paused = false;\n  stream.on('end', function () {\n    debug('wrapped end');\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) _this.push(chunk);\n    }\n    _this.push(null);\n  });\n  stream.on('data', function (chunk) {\n    debug('wrapped data');\n    if (state.decoder) chunk = state.decoder.write(chunk);\n\n    // don't skip over falsy values in objectMode\n    if (state.objectMode && (chunk === null || chunk === undefined)) return;else if (!state.objectMode && (!chunk || !chunk.length)) return;\n    var ret = _this.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (this[i] === undefined && typeof stream[i] === 'function') {\n      this[i] = function methodWrap(method) {\n        return function methodWrapReturnFunction() {\n          return stream[method].apply(stream, arguments);\n        };\n      }(i);\n    }\n  }\n\n  // proxy certain important events.\n  for (var n = 0; n < kProxyEvents.length; n++) {\n    stream.on(kProxyEvents[n], this.emit.bind(this, kProxyEvents[n]));\n  }\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  this._read = function (n) {\n    debug('wrapped _read', n);\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n  return this;\n};\nif (typeof Symbol === 'function') {\n  Readable.prototype[Symbol.asyncIterator] = function () {\n    if (createReadableStreamAsyncIterator === undefined) {\n      createReadableStreamAsyncIterator = require('./internal/streams/async_iterator');\n    }\n    return createReadableStreamAsyncIterator(this);\n  };\n}\nObject.defineProperty(Readable.prototype, 'readableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.highWaterMark;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState && this._readableState.buffer;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableFlowing', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.flowing;\n  },\n  set: function set(state) {\n    if (this._readableState) {\n      this._readableState.flowing = state;\n    }\n  }\n});\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\nObject.defineProperty(Readable.prototype, 'readableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.length;\n  }\n});\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromList(n, state) {\n  // nothing buffered\n  if (state.length === 0) return null;\n  var ret;\n  if (state.objectMode) ret = state.buffer.shift();else if (!n || n >= state.length) {\n    // read it all, truncate the list\n    if (state.decoder) ret = state.buffer.join('');else if (state.buffer.length === 1) ret = state.buffer.first();else ret = state.buffer.concat(state.length);\n    state.buffer.clear();\n  } else {\n    // read part of list\n    ret = state.buffer.consume(n, state.decoder);\n  }\n  return ret;\n}\nfunction endReadable(stream) {\n  var state = stream._readableState;\n  debug('endReadable', state.endEmitted);\n  if (!state.endEmitted) {\n    state.ended = true;\n    process.nextTick(endReadableNT, state, stream);\n  }\n}\nfunction endReadableNT(state, stream) {\n  debug('endReadableNT', state.endEmitted, state.length);\n\n  // Check that we didn't get one last unshift.\n  if (!state.endEmitted && state.length === 0) {\n    state.endEmitted = true;\n    stream.readable = false;\n    stream.emit('end');\n    if (state.autoDestroy) {\n      // In case of duplex streams we need a way to detect\n      // if the writable side is ready for autoDestroy as well\n      var wState = stream._writableState;\n      if (!wState || wState.autoDestroy && wState.finished) {\n        stream.destroy();\n      }\n    }\n  }\n}\nif (typeof Symbol === 'function') {\n  Readable.from = function (iterable, opts) {\n    if (from === undefined) {\n      from = require('./internal/streams/from');\n    }\n    return from(Readable, iterable, opts);\n  };\n}\nfunction indexOf(xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}","module.exports = require(\"events\");","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function (val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nlet promise\n\nmodule.exports = typeof queueMicrotask === 'function'\n  ? queueMicrotask.bind(typeof window !== 'undefined' ? window : global)\n  // reuse resolved promise, and allocate it lazily\n  : cb => (promise || (promise = Promise.resolve()))\n    .then(cb)\n    .catch(err => setTimeout(() => { throw err }, 0))\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\n'use strict';\n\nmodule.exports = PassThrough;\nvar Transform = require('./_stream_transform');\nrequire('inherits')(PassThrough, Transform);\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough)) return new PassThrough(options);\n  Transform.call(this, options);\n}\nPassThrough.prototype._transform = function (chunk, encoding, cb) {\n  cb(null, chunk);\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\n'use strict';\n\nmodule.exports = Transform;\nvar _require$codes = require('../errors').codes,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_TRANSFORM_ALREADY_TRANSFORMING = _require$codes.ERR_TRANSFORM_ALREADY_TRANSFORMING,\n  ERR_TRANSFORM_WITH_LENGTH_0 = _require$codes.ERR_TRANSFORM_WITH_LENGTH_0;\nvar Duplex = require('./_stream_duplex');\nrequire('inherits')(Transform, Duplex);\nfunction afterTransform(er, data) {\n  var ts = this._transformState;\n  ts.transforming = false;\n  var cb = ts.writecb;\n  if (cb === null) {\n    return this.emit('error', new ERR_MULTIPLE_CALLBACK());\n  }\n  ts.writechunk = null;\n  ts.writecb = null;\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    this.push(data);\n  cb(er);\n  var rs = this._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    this._read(rs.highWaterMark);\n  }\n}\nfunction Transform(options) {\n  if (!(this instanceof Transform)) return new Transform(options);\n  Duplex.call(this, options);\n  this._transformState = {\n    afterTransform: afterTransform.bind(this),\n    needTransform: false,\n    transforming: false,\n    writecb: null,\n    writechunk: null,\n    writeencoding: null\n  };\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n  if (options) {\n    if (typeof options.transform === 'function') this._transform = options.transform;\n    if (typeof options.flush === 'function') this._flush = options.flush;\n  }\n\n  // When the writable side finishes, then flush out anything remaining.\n  this.on('prefinish', prefinish);\n}\nfunction prefinish() {\n  var _this = this;\n  if (typeof this._flush === 'function' && !this._readableState.destroyed) {\n    this._flush(function (er, data) {\n      done(_this, er, data);\n    });\n  } else {\n    done(this, null, null);\n  }\n}\nTransform.prototype.push = function (chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_transform()'));\n};\nTransform.prototype._write = function (chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform || rs.needReadable || rs.length < rs.highWaterMark) this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function (n) {\n  var ts = this._transformState;\n  if (ts.writechunk !== null && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\nTransform.prototype._destroy = function (err, cb) {\n  Duplex.prototype._destroy.call(this, err, function (err2) {\n    cb(err2);\n  });\n};\nfunction done(stream, er, data) {\n  if (er) return stream.emit('error', er);\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    stream.push(data);\n\n  // TODO(BridgeAR): Write a test for these two error cases\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  if (stream._writableState.length) throw new ERR_TRANSFORM_WITH_LENGTH_0();\n  if (stream._transformState.transforming) throw new ERR_TRANSFORM_ALREADY_TRANSFORMING();\n  return stream.push(null);\n}","\n/**\n * Module exports.\n */\n\nmodule.exports = deprecate;\n\n/**\n * Mark that a method should not be used.\n * Returns a modified function which warns once by default.\n *\n * If `localStorage.noDeprecation = true` is set, then it is a no-op.\n *\n * If `localStorage.throwDeprecation = true` is set, then deprecated functions\n * will throw an Error when invoked.\n *\n * If `localStorage.traceDeprecation = true` is set, then deprecated functions\n * will invoke `console.trace()` instead of `console.error()`.\n *\n * @param {Function} fn - the function to deprecate\n * @param {String} msg - the string to print to the console when `fn` is invoked\n * @returns {Function} a new \"deprecated\" version of `fn`\n * @api public\n */\n\nfunction deprecate (fn, msg) {\n  if (config('noDeprecation')) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (config('throwDeprecation')) {\n        throw new Error(msg);\n      } else if (config('traceDeprecation')) {\n        console.trace(msg);\n      } else {\n        console.warn(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n}\n\n/**\n * Checks `localStorage` for boolean values for the given `name`.\n *\n * @param {String} name\n * @returns {Boolean}\n * @api private\n */\n\nfunction config (name) {\n  // accessing global.localStorage can trigger a DOMException in sandboxed iframes\n  try {\n    if (!global.localStorage) return false;\n  } catch (_) {\n    return false;\n  }\n  var val = global.localStorage[name];\n  if (null == val) return false;\n  return String(val).toLowerCase() === 'true';\n}\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, encoding, cb), and it'll handle all\n// the drain event emission and buffering.\n\n'use strict';\n\nmodule.exports = Writable;\n\n/* <replacement> */\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n  this.next = null;\n}\n\n// It seems a linked list but it is not\n// there will be only 2 of these for each stream\nfunction CorkedRequest(state) {\n  var _this = this;\n  this.next = null;\n  this.entry = null;\n  this.finish = function () {\n    onCorkedFinish(_this, state);\n  };\n}\n/* </replacement> */\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n/*<replacement>*/\nvar internalUtil = {\n  deprecate: require('util-deprecate')\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_STREAM_CANNOT_PIPE = _require$codes.ERR_STREAM_CANNOT_PIPE,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED,\n  ERR_STREAM_NULL_VALUES = _require$codes.ERR_STREAM_NULL_VALUES,\n  ERR_STREAM_WRITE_AFTER_END = _require$codes.ERR_STREAM_WRITE_AFTER_END,\n  ERR_UNKNOWN_ENCODING = _require$codes.ERR_UNKNOWN_ENCODING;\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nrequire('inherits')(Writable, Stream);\nfunction nop() {}\nfunction WritableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream,\n  // e.g. options.readableObjectMode vs. options.writableObjectMode, etc.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.writableObjectMode;\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  this.highWaterMark = getHighWaterMark(this, options, 'writableHighWaterMark', isDuplex);\n\n  // if _final has been called\n  this.finalCalled = false;\n\n  // drain event flag.\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // when true all writes will be buffered until .uncork() call\n  this.corked = 0;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, because any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function (er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n  this.bufferedRequest = null;\n  this.lastBufferedRequest = null;\n\n  // number of pending user-supplied write callbacks\n  // this must be 0 before 'finish' can be emitted\n  this.pendingcb = 0;\n\n  // emit prefinish if the only thing we're waiting for is _write cbs\n  // This is relevant for synchronous Transform streams\n  this.prefinished = false;\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'finish' (and potentially 'end')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // count buffered requests\n  this.bufferedRequestCount = 0;\n\n  // allocate the first CorkedRequest, there is always\n  // one allocated and free to use, and we maintain at most two\n  this.corkedRequestsFree = new CorkedRequest(this);\n}\nWritableState.prototype.getBuffer = function getBuffer() {\n  var current = this.bufferedRequest;\n  var out = [];\n  while (current) {\n    out.push(current);\n    current = current.next;\n  }\n  return out;\n};\n(function () {\n  try {\n    Object.defineProperty(WritableState.prototype, 'buffer', {\n      get: internalUtil.deprecate(function writableStateBufferGetter() {\n        return this.getBuffer();\n      }, '_writableState.buffer is deprecated. Use _writableState.getBuffer ' + 'instead.', 'DEP0003')\n    });\n  } catch (_) {}\n})();\n\n// Test _writableState for inheritance to account for Duplex streams,\n// whose prototype chain only points to Readable.\nvar realHasInstance;\nif (typeof Symbol === 'function' && Symbol.hasInstance && typeof Function.prototype[Symbol.hasInstance] === 'function') {\n  realHasInstance = Function.prototype[Symbol.hasInstance];\n  Object.defineProperty(Writable, Symbol.hasInstance, {\n    value: function value(object) {\n      if (realHasInstance.call(this, object)) return true;\n      if (this !== Writable) return false;\n      return object && object._writableState instanceof WritableState;\n    }\n  });\n} else {\n  realHasInstance = function realHasInstance(object) {\n    return object instanceof this;\n  };\n}\nfunction Writable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, too.\n  // `realHasInstance` is necessary because using plain `instanceof`\n  // would return false, as no `_writableState` property is attached.\n\n  // Trying to use the custom `instanceof` for Writable here will also break the\n  // Node.js LazyTransform implementation, which has a non-trivial getter for\n  // `_writableState` that would lead to infinite recursion.\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the WritableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  if (!isDuplex && !realHasInstance.call(Writable, this)) return new Writable(options);\n  this._writableState = new WritableState(options, this, isDuplex);\n\n  // legacy.\n  this.writable = true;\n  if (options) {\n    if (typeof options.write === 'function') this._write = options.write;\n    if (typeof options.writev === 'function') this._writev = options.writev;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n    if (typeof options.final === 'function') this._final = options.final;\n  }\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function () {\n  errorOrDestroy(this, new ERR_STREAM_CANNOT_PIPE());\n};\nfunction writeAfterEnd(stream, cb) {\n  var er = new ERR_STREAM_WRITE_AFTER_END();\n  // TODO: defer error events consistently everywhere, not just the cb\n  errorOrDestroy(stream, er);\n  process.nextTick(cb, er);\n}\n\n// Checks that a user-supplied chunk is valid, especially for the particular\n// mode the stream is in. Currently this means that `null` is never accepted\n// and undefined/non-string values are only allowed in object mode.\nfunction validChunk(stream, state, chunk, cb) {\n  var er;\n  if (chunk === null) {\n    er = new ERR_STREAM_NULL_VALUES();\n  } else if (typeof chunk !== 'string' && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer'], chunk);\n  }\n  if (er) {\n    errorOrDestroy(stream, er);\n    process.nextTick(cb, er);\n    return false;\n  }\n  return true;\n}\nWritable.prototype.write = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n  var isBuf = !state.objectMode && _isUint8Array(chunk);\n  if (isBuf && !Buffer.isBuffer(chunk)) {\n    chunk = _uint8ArrayToBuffer(chunk);\n  }\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (isBuf) encoding = 'buffer';else if (!encoding) encoding = state.defaultEncoding;\n  if (typeof cb !== 'function') cb = nop;\n  if (state.ending) writeAfterEnd(this, cb);else if (isBuf || validChunk(this, state, chunk, cb)) {\n    state.pendingcb++;\n    ret = writeOrBuffer(this, state, isBuf, chunk, encoding, cb);\n  }\n  return ret;\n};\nWritable.prototype.cork = function () {\n  this._writableState.corked++;\n};\nWritable.prototype.uncork = function () {\n  var state = this._writableState;\n  if (state.corked) {\n    state.corked--;\n    if (!state.writing && !state.corked && !state.bufferProcessing && state.bufferedRequest) clearBuffer(this, state);\n  }\n};\nWritable.prototype.setDefaultEncoding = function setDefaultEncoding(encoding) {\n  // node::ParseEncoding() requires lower case.\n  if (typeof encoding === 'string') encoding = encoding.toLowerCase();\n  if (!(['hex', 'utf8', 'utf-8', 'ascii', 'binary', 'base64', 'ucs2', 'ucs-2', 'utf16le', 'utf-16le', 'raw'].indexOf((encoding + '').toLowerCase()) > -1)) throw new ERR_UNKNOWN_ENCODING(encoding);\n  this._writableState.defaultEncoding = encoding;\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode && state.decodeStrings !== false && typeof chunk === 'string') {\n    chunk = Buffer.from(chunk, encoding);\n  }\n  return chunk;\n}\nObject.defineProperty(Writable.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, isBuf, chunk, encoding, cb) {\n  if (!isBuf) {\n    var newChunk = decodeChunk(state, chunk, encoding);\n    if (chunk !== newChunk) {\n      isBuf = true;\n      encoding = 'buffer';\n      chunk = newChunk;\n    }\n  }\n  var len = state.objectMode ? 1 : chunk.length;\n  state.length += len;\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret) state.needDrain = true;\n  if (state.writing || state.corked) {\n    var last = state.lastBufferedRequest;\n    state.lastBufferedRequest = {\n      chunk: chunk,\n      encoding: encoding,\n      isBuf: isBuf,\n      callback: cb,\n      next: null\n    };\n    if (last) {\n      last.next = state.lastBufferedRequest;\n    } else {\n      state.bufferedRequest = state.lastBufferedRequest;\n    }\n    state.bufferedRequestCount += 1;\n  } else {\n    doWrite(stream, state, false, len, chunk, encoding, cb);\n  }\n  return ret;\n}\nfunction doWrite(stream, state, writev, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  if (state.destroyed) state.onwrite(new ERR_STREAM_DESTROYED('write'));else if (writev) stream._writev(chunk, state.onwrite);else stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\nfunction onwriteError(stream, state, sync, er, cb) {\n  --state.pendingcb;\n  if (sync) {\n    // defer the callback if we are being called synchronously\n    // to avoid piling up things on the stack\n    process.nextTick(cb, er);\n    // this can emit finish, and it will always happen\n    // after error\n    process.nextTick(finishMaybe, stream, state);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n  } else {\n    // the caller expect this to happen before if\n    // it is async\n    cb(er);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n    // this can emit finish, but finish must\n    // always follow error\n    finishMaybe(stream, state);\n  }\n}\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n  if (typeof cb !== 'function') throw new ERR_MULTIPLE_CALLBACK();\n  onwriteStateUpdate(state);\n  if (er) onwriteError(stream, state, sync, er, cb);else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(state) || stream.destroyed;\n    if (!finished && !state.corked && !state.bufferProcessing && state.bufferedRequest) {\n      clearBuffer(stream, state);\n    }\n    if (sync) {\n      process.nextTick(afterWrite, stream, state, finished, cb);\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished) onwriteDrain(stream, state);\n  state.pendingcb--;\n  cb();\n  finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n  var entry = state.bufferedRequest;\n  if (stream._writev && entry && entry.next) {\n    // Fast case, write everything using _writev()\n    var l = state.bufferedRequestCount;\n    var buffer = new Array(l);\n    var holder = state.corkedRequestsFree;\n    holder.entry = entry;\n    var count = 0;\n    var allBuffers = true;\n    while (entry) {\n      buffer[count] = entry;\n      if (!entry.isBuf) allBuffers = false;\n      entry = entry.next;\n      count += 1;\n    }\n    buffer.allBuffers = allBuffers;\n    doWrite(stream, state, true, state.length, buffer, '', holder.finish);\n\n    // doWrite is almost always async, defer these to save a bit of time\n    // as the hot path ends with doWrite\n    state.pendingcb++;\n    state.lastBufferedRequest = null;\n    if (holder.next) {\n      state.corkedRequestsFree = holder.next;\n      holder.next = null;\n    } else {\n      state.corkedRequestsFree = new CorkedRequest(state);\n    }\n    state.bufferedRequestCount = 0;\n  } else {\n    // Slow case, write chunks one-by-one\n    while (entry) {\n      var chunk = entry.chunk;\n      var encoding = entry.encoding;\n      var cb = entry.callback;\n      var len = state.objectMode ? 1 : chunk.length;\n      doWrite(stream, state, false, len, chunk, encoding, cb);\n      entry = entry.next;\n      state.bufferedRequestCount--;\n      // if we didn't call the onwrite immediately, then\n      // it means that we need to wait until it does.\n      // also, that means that the chunk and cb are currently\n      // being processed, so move the buffer counter past them.\n      if (state.writing) {\n        break;\n      }\n    }\n    if (entry === null) state.lastBufferedRequest = null;\n  }\n  state.bufferedRequest = entry;\n  state.bufferProcessing = false;\n}\nWritable.prototype._write = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_write()'));\n};\nWritable.prototype._writev = null;\nWritable.prototype.end = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (chunk !== null && chunk !== undefined) this.write(chunk, encoding);\n\n  // .end() fully uncorks\n  if (state.corked) {\n    state.corked = 1;\n    this.uncork();\n  }\n\n  // ignore unnecessary end() calls.\n  if (!state.ending) endWritable(this, state, cb);\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\nfunction needFinish(state) {\n  return state.ending && state.length === 0 && state.bufferedRequest === null && !state.finished && !state.writing;\n}\nfunction callFinal(stream, state) {\n  stream._final(function (err) {\n    state.pendingcb--;\n    if (err) {\n      errorOrDestroy(stream, err);\n    }\n    state.prefinished = true;\n    stream.emit('prefinish');\n    finishMaybe(stream, state);\n  });\n}\nfunction prefinish(stream, state) {\n  if (!state.prefinished && !state.finalCalled) {\n    if (typeof stream._final === 'function' && !state.destroyed) {\n      state.pendingcb++;\n      state.finalCalled = true;\n      process.nextTick(callFinal, stream, state);\n    } else {\n      state.prefinished = true;\n      stream.emit('prefinish');\n    }\n  }\n}\nfunction finishMaybe(stream, state) {\n  var need = needFinish(state);\n  if (need) {\n    prefinish(stream, state);\n    if (state.pendingcb === 0) {\n      state.finished = true;\n      stream.emit('finish');\n      if (state.autoDestroy) {\n        // In case of duplex streams we need a way to detect\n        // if the readable side is ready for autoDestroy as well\n        var rState = stream._readableState;\n        if (!rState || rState.autoDestroy && rState.endEmitted) {\n          stream.destroy();\n        }\n      }\n    }\n  }\n  return need;\n}\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished) process.nextTick(cb);else stream.once('finish', cb);\n  }\n  state.ended = true;\n  stream.writable = false;\n}\nfunction onCorkedFinish(corkReq, state, err) {\n  var entry = corkReq.entry;\n  corkReq.entry = null;\n  while (entry) {\n    var cb = entry.callback;\n    state.pendingcb--;\n    cb(err);\n    entry = entry.next;\n  }\n\n  // reuse the free corkReq.\n  state.corkedRequestsFree.next = corkReq;\n}\nObject.defineProperty(Writable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._writableState === undefined) {\n      return false;\n    }\n    return this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._writableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._writableState.destroyed = value;\n  }\n});\nWritable.prototype.destroy = destroyImpl.destroy;\nWritable.prototype._undestroy = destroyImpl.undestroy;\nWritable.prototype._destroy = function (err, cb) {\n  cb(err);\n};","'use strict';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar _require = require('buffer'),\n  Buffer = _require.Buffer;\nvar _require2 = require('util'),\n  inspect = _require2.inspect;\nvar custom = inspect && inspect.custom || 'inspect';\nfunction copyBuffer(src, target, offset) {\n  Buffer.prototype.copy.call(src, target, offset);\n}\nmodule.exports = /*#__PURE__*/function () {\n  function BufferList() {\n    _classCallCheck(this, BufferList);\n    this.head = null;\n    this.tail = null;\n    this.length = 0;\n  }\n  _createClass(BufferList, [{\n    key: \"push\",\n    value: function push(v) {\n      var entry = {\n        data: v,\n        next: null\n      };\n      if (this.length > 0) this.tail.next = entry;else this.head = entry;\n      this.tail = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"unshift\",\n    value: function unshift(v) {\n      var entry = {\n        data: v,\n        next: this.head\n      };\n      if (this.length === 0) this.tail = entry;\n      this.head = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"shift\",\n    value: function shift() {\n      if (this.length === 0) return;\n      var ret = this.head.data;\n      if (this.length === 1) this.head = this.tail = null;else this.head = this.head.next;\n      --this.length;\n      return ret;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.head = this.tail = null;\n      this.length = 0;\n    }\n  }, {\n    key: \"join\",\n    value: function join(s) {\n      if (this.length === 0) return '';\n      var p = this.head;\n      var ret = '' + p.data;\n      while (p = p.next) ret += s + p.data;\n      return ret;\n    }\n  }, {\n    key: \"concat\",\n    value: function concat(n) {\n      if (this.length === 0) return Buffer.alloc(0);\n      var ret = Buffer.allocUnsafe(n >>> 0);\n      var p = this.head;\n      var i = 0;\n      while (p) {\n        copyBuffer(p.data, ret, i);\n        i += p.data.length;\n        p = p.next;\n      }\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes or characters from the buffered data.\n  }, {\n    key: \"consume\",\n    value: function consume(n, hasStrings) {\n      var ret;\n      if (n < this.head.data.length) {\n        // `slice` is the same for buffers and strings.\n        ret = this.head.data.slice(0, n);\n        this.head.data = this.head.data.slice(n);\n      } else if (n === this.head.data.length) {\n        // First chunk is a perfect match.\n        ret = this.shift();\n      } else {\n        // Result spans more than one buffer.\n        ret = hasStrings ? this._getString(n) : this._getBuffer(n);\n      }\n      return ret;\n    }\n  }, {\n    key: \"first\",\n    value: function first() {\n      return this.head.data;\n    }\n\n    // Consumes a specified amount of characters from the buffered data.\n  }, {\n    key: \"_getString\",\n    value: function _getString(n) {\n      var p = this.head;\n      var c = 1;\n      var ret = p.data;\n      n -= ret.length;\n      while (p = p.next) {\n        var str = p.data;\n        var nb = n > str.length ? str.length : n;\n        if (nb === str.length) ret += str;else ret += str.slice(0, n);\n        n -= nb;\n        if (n === 0) {\n          if (nb === str.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = str.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes from the buffered data.\n  }, {\n    key: \"_getBuffer\",\n    value: function _getBuffer(n) {\n      var ret = Buffer.allocUnsafe(n);\n      var p = this.head;\n      var c = 1;\n      p.data.copy(ret);\n      n -= p.data.length;\n      while (p = p.next) {\n        var buf = p.data;\n        var nb = n > buf.length ? buf.length : n;\n        buf.copy(ret, ret.length - n, 0, nb);\n        n -= nb;\n        if (n === 0) {\n          if (nb === buf.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = buf.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Make sure the linked list only shows the minimal necessary information.\n  }, {\n    key: custom,\n    value: function value(_, options) {\n      return inspect(this, _objectSpread(_objectSpread({}, options), {}, {\n        // Only inspect one level.\n        depth: 0,\n        // It should not recurse.\n        customInspect: false\n      }));\n    }\n  }]);\n  return BufferList;\n}();","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\tcreateDebug.destroy = destroy;\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\t\tlet enableOverride = null;\n\t\tlet namespacesCache;\n\t\tlet enabledCache;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn '%';\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = createDebug.selectColor(namespace);\n\t\tdebug.extend = extend;\n\t\tdebug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.\n\n\t\tObject.defineProperty(debug, 'enabled', {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget: () => {\n\t\t\t\tif (enableOverride !== null) {\n\t\t\t\t\treturn enableOverride;\n\t\t\t\t}\n\t\t\t\tif (namespacesCache !== createDebug.namespaces) {\n\t\t\t\t\tnamespacesCache = createDebug.namespaces;\n\t\t\t\t\tenabledCache = createDebug.enabled(namespace);\n\t\t\t\t}\n\n\t\t\t\treturn enabledCache;\n\t\t\t},\n\t\t\tset: v => {\n\t\t\t\tenableOverride = v;\n\t\t\t}\n\t\t});\n\n\t\t// Env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\treturn debug;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\t\tcreateDebug.namespaces = namespaces;\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '')\n\t\t\t.trim()\n\t\t\t.replace(/\\s+/g, ',')\n\t\t\t.split(',')\n\t\t\t.filter(Boolean);\n\n\t\tfor (const ns of split) {\n\t\t\tif (ns[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(ns.slice(1));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(ns);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the given string matches a namespace template, honoring\n\t * asterisks as wildcards.\n\t *\n\t * @param {String} search\n\t * @param {String} template\n\t * @return {Boolean}\n\t */\n\tfunction matchesTemplate(search, template) {\n\t\tlet searchIndex = 0;\n\t\tlet templateIndex = 0;\n\t\tlet starIndex = -1;\n\t\tlet matchIndex = 0;\n\n\t\twhile (searchIndex < search.length) {\n\t\t\tif (templateIndex < template.length && (template[templateIndex] === search[searchIndex] || template[templateIndex] === '*')) {\n\t\t\t\t// Match character or proceed with wildcard\n\t\t\t\tif (template[templateIndex] === '*') {\n\t\t\t\t\tstarIndex = templateIndex;\n\t\t\t\t\tmatchIndex = searchIndex;\n\t\t\t\t\ttemplateIndex++; // Skip the '*'\n\t\t\t\t} else {\n\t\t\t\t\tsearchIndex++;\n\t\t\t\t\ttemplateIndex++;\n\t\t\t\t}\n\t\t\t} else if (starIndex !== -1) { // eslint-disable-line no-negated-condition\n\t\t\t\t// Backtrack to the last '*' and try to match more characters\n\t\t\t\ttemplateIndex = starIndex + 1;\n\t\t\t\tmatchIndex++;\n\t\t\t\tsearchIndex = matchIndex;\n\t\t\t} else {\n\t\t\t\treturn false; // No match\n\t\t\t}\n\t\t}\n\n\t\t// Handle trailing '*' in template\n\t\twhile (templateIndex < template.length && template[templateIndex] === '*') {\n\t\t\ttemplateIndex++;\n\t\t}\n\n\t\treturn templateIndex === template.length;\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names,\n\t\t\t...createDebug.skips.map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tfor (const skip of createDebug.skips) {\n\t\t\tif (matchesTemplate(name, skip)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (const ns of createDebug.names) {\n\t\t\tif (matchesTemplate(name, ns)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\t/**\n\t* XXX DO NOT USE. This is a temporary stub function.\n\t* XXX It WILL be removed in the next major release.\n\t*/\n\tfunction destroy() {\n\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","// Ported from https://github.com/mafintosh/pump with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar eos;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    callback.apply(void 0, arguments);\n  };\n}\nvar _require$codes = require('../../../errors').codes,\n  ERR_MISSING_ARGS = _require$codes.ERR_MISSING_ARGS,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED;\nfunction noop(err) {\n  // Rethrow the error if it exists to avoid swallowing it\n  if (err) throw err;\n}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction destroyer(stream, reading, writing, callback) {\n  callback = once(callback);\n  var closed = false;\n  stream.on('close', function () {\n    closed = true;\n  });\n  if (eos === undefined) eos = require('./end-of-stream');\n  eos(stream, {\n    readable: reading,\n    writable: writing\n  }, function (err) {\n    if (err) return callback(err);\n    closed = true;\n    callback();\n  });\n  var destroyed = false;\n  return function (err) {\n    if (closed) return;\n    if (destroyed) return;\n    destroyed = true;\n\n    // request.destroy just do .end - .abort is what we want\n    if (isRequest(stream)) return stream.abort();\n    if (typeof stream.destroy === 'function') return stream.destroy();\n    callback(err || new ERR_STREAM_DESTROYED('pipe'));\n  };\n}\nfunction call(fn) {\n  fn();\n}\nfunction pipe(from, to) {\n  return from.pipe(to);\n}\nfunction popCallback(streams) {\n  if (!streams.length) return noop;\n  if (typeof streams[streams.length - 1] !== 'function') return noop;\n  return streams.pop();\n}\nfunction pipeline() {\n  for (var _len = arguments.length, streams = new Array(_len), _key = 0; _key < _len; _key++) {\n    streams[_key] = arguments[_key];\n  }\n  var callback = popCallback(streams);\n  if (Array.isArray(streams[0])) streams = streams[0];\n  if (streams.length < 2) {\n    throw new ERR_MISSING_ARGS('streams');\n  }\n  var error;\n  var destroys = streams.map(function (stream, i) {\n    var reading = i < streams.length - 1;\n    var writing = i > 0;\n    return destroyer(stream, reading, writing, function (err) {\n      if (!error) error = err;\n      if (err) destroys.forEach(call);\n      if (reading) return;\n      destroys.forEach(call);\n      callback(error);\n    });\n  });\n  return streams.reduce(pipe);\n}\nmodule.exports = pipeline;","/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nconst debug = require('debug')('simple-peer')\nconst getBrowserRTC = require('get-browser-rtc')\nconst randombytes = require('randombytes')\nconst stream = require('readable-stream')\nconst queueMicrotask = require('queue-microtask') // TODO: remove when Node 10 is not supported\nconst errCode = require('err-code')\nconst { Buffer } = require('buffer')\n\nconst MAX_BUFFERED_AMOUNT = 64 * 1024\nconst ICECOMPLETE_TIMEOUT = 5 * 1000\nconst CHANNEL_CLOSING_TIMEOUT = 5 * 1000\n\n// HACK: Filter trickle lines when trickle is disabled #354\nfunction filterTrickle (sdp) {\n  return sdp.replace(/a=ice-options:trickle\\s\\n/g, '')\n}\n\nfunction warn (message) {\n  console.warn(message)\n}\n\n/**\n * WebRTC peer connection. Same API as node core `net.Socket`, plus a few extra methods.\n * Duplex stream.\n * @param {Object} opts\n */\nclass Peer extends stream.Duplex {\n  constructor (opts) {\n    opts = Object.assign({\n      allowHalfOpen: false\n    }, opts)\n\n    super(opts)\n\n    this._id = randombytes(4).toString('hex').slice(0, 7)\n    this._debug('new peer %o', opts)\n\n    this.channelName = opts.initiator\n      ? opts.channelName || randombytes(20).toString('hex')\n      : null\n\n    this.initiator = opts.initiator || false\n    this.channelConfig = opts.channelConfig || Peer.channelConfig\n    this.channelNegotiated = this.channelConfig.negotiated\n    this.config = Object.assign({}, Peer.config, opts.config)\n    this.offerOptions = opts.offerOptions || {}\n    this.answerOptions = opts.answerOptions || {}\n    this.sdpTransform = opts.sdpTransform || (sdp => sdp)\n    this.streams = opts.streams || (opts.stream ? [opts.stream] : []) // support old \"stream\" option\n    this.trickle = opts.trickle !== undefined ? opts.trickle : true\n    this.allowHalfTrickle = opts.allowHalfTrickle !== undefined ? opts.allowHalfTrickle : false\n    this.iceCompleteTimeout = opts.iceCompleteTimeout || ICECOMPLETE_TIMEOUT\n\n    this.destroyed = false\n    this.destroying = false\n    this._connected = false\n\n    this.remoteAddress = undefined\n    this.remoteFamily = undefined\n    this.remotePort = undefined\n    this.localAddress = undefined\n    this.localFamily = undefined\n    this.localPort = undefined\n\n    this._wrtc = (opts.wrtc && typeof opts.wrtc === 'object')\n      ? opts.wrtc\n      : getBrowserRTC()\n\n    if (!this._wrtc) {\n      if (typeof window === 'undefined') {\n        throw errCode(new Error('No WebRTC support: Specify `opts.wrtc` option in this environment'), 'ERR_WEBRTC_SUPPORT')\n      } else {\n        throw errCode(new Error('No WebRTC support: Not a supported browser'), 'ERR_WEBRTC_SUPPORT')\n      }\n    }\n\n    this._pcReady = false\n    this._channelReady = false\n    this._iceComplete = false // ice candidate trickle done (got null candidate)\n    this._iceCompleteTimer = null // send an offer/answer anyway after some timeout\n    this._channel = null\n    this._pendingCandidates = []\n\n    this._isNegotiating = false // is this peer waiting for negotiation to complete?\n    this._firstNegotiation = true\n    this._batchedNegotiation = false // batch synchronous negotiations\n    this._queuedNegotiation = false // is there a queued negotiation request?\n    this._sendersAwaitingStable = []\n    this._senderMap = new Map()\n    this._closingInterval = null\n\n    this._remoteTracks = []\n    this._remoteStreams = []\n\n    this._chunk = null\n    this._cb = null\n    this._interval = null\n\n    try {\n      this._pc = new (this._wrtc.RTCPeerConnection)(this.config)\n    } catch (err) {\n      this.destroy(errCode(err, 'ERR_PC_CONSTRUCTOR'))\n      return\n    }\n\n    // We prefer feature detection whenever possible, but sometimes that's not\n    // possible for certain implementations.\n    this._isReactNativeWebrtc = typeof this._pc._peerConnectionId === 'number'\n\n    this._pc.oniceconnectionstatechange = () => {\n      this._onIceStateChange()\n    }\n    this._pc.onicegatheringstatechange = () => {\n      this._onIceStateChange()\n    }\n    this._pc.onconnectionstatechange = () => {\n      this._onConnectionStateChange()\n    }\n    this._pc.onsignalingstatechange = () => {\n      this._onSignalingStateChange()\n    }\n    this._pc.onicecandidate = event => {\n      this._onIceCandidate(event)\n    }\n\n    // HACK: Fix for odd Firefox behavior, see: https://github.com/feross/simple-peer/pull/783\n    if (typeof this._pc.peerIdentity === 'object') {\n      this._pc.peerIdentity.catch(err => {\n        this.destroy(errCode(err, 'ERR_PC_PEER_IDENTITY'))\n      })\n    }\n\n    // Other spec events, unused by this implementation:\n    // - onconnectionstatechange\n    // - onicecandidateerror\n    // - onfingerprintfailure\n    // - onnegotiationneeded\n\n    if (this.initiator || this.channelNegotiated) {\n      this._setupData({\n        channel: this._pc.createDataChannel(this.channelName, this.channelConfig)\n      })\n    } else {\n      this._pc.ondatachannel = event => {\n        this._setupData(event)\n      }\n    }\n\n    if (this.streams) {\n      this.streams.forEach(stream => {\n        this.addStream(stream)\n      })\n    }\n    this._pc.ontrack = event => {\n      this._onTrack(event)\n    }\n\n    this._debug('initial negotiation')\n    this._needsNegotiation()\n\n    this._onFinishBound = () => {\n      this._onFinish()\n    }\n    this.once('finish', this._onFinishBound)\n  }\n\n  get bufferSize () {\n    return (this._channel && this._channel.bufferedAmount) || 0\n  }\n\n  // HACK: it's possible channel.readyState is \"closing\" before peer.destroy() fires\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n  get connected () {\n    return (this._connected && this._channel.readyState === 'open')\n  }\n\n  address () {\n    return { port: this.localPort, family: this.localFamily, address: this.localAddress }\n  }\n\n  signal (data) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot signal after peer is destroyed'), 'ERR_DESTROYED')\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data)\n      } catch (err) {\n        data = {}\n      }\n    }\n    this._debug('signal()')\n\n    if (data.renegotiate && this.initiator) {\n      this._debug('got request to renegotiate')\n      this._needsNegotiation()\n    }\n    if (data.transceiverRequest && this.initiator) {\n      this._debug('got request for transceiver')\n      this.addTransceiver(data.transceiverRequest.kind, data.transceiverRequest.init)\n    }\n    if (data.candidate) {\n      if (this._pc.remoteDescription && this._pc.remoteDescription.type) {\n        this._addIceCandidate(data.candidate)\n      } else {\n        this._pendingCandidates.push(data.candidate)\n      }\n    }\n    if (data.sdp) {\n      this._pc.setRemoteDescription(new (this._wrtc.RTCSessionDescription)(data))\n        .then(() => {\n          if (this.destroyed) return\n\n          this._pendingCandidates.forEach(candidate => {\n            this._addIceCandidate(candidate)\n          })\n          this._pendingCandidates = []\n\n          if (this._pc.remoteDescription.type === 'offer') this._createAnswer()\n        })\n        .catch(err => {\n          this.destroy(errCode(err, 'ERR_SET_REMOTE_DESCRIPTION'))\n        })\n    }\n    if (!data.sdp && !data.candidate && !data.renegotiate && !data.transceiverRequest) {\n      this.destroy(errCode(new Error('signal() called with invalid signal data'), 'ERR_SIGNALING'))\n    }\n  }\n\n  _addIceCandidate (candidate) {\n    const iceCandidateObj = new this._wrtc.RTCIceCandidate(candidate)\n    this._pc.addIceCandidate(iceCandidateObj)\n      .catch(err => {\n        if (!iceCandidateObj.address || iceCandidateObj.address.endsWith('.local')) {\n          warn('Ignoring unsupported ICE candidate.')\n        } else {\n          this.destroy(errCode(err, 'ERR_ADD_ICE_CANDIDATE'))\n        }\n      })\n  }\n\n  /**\n   * Send text/binary data to the remote peer.\n   * @param {ArrayBufferView|ArrayBuffer|Buffer|string|Blob} chunk\n   */\n  send (chunk) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot send after peer is destroyed'), 'ERR_DESTROYED')\n    this._channel.send(chunk)\n  }\n\n  /**\n   * Add a Transceiver to the connection.\n   * @param {String} kind\n   * @param {Object} init\n   */\n  addTransceiver (kind, init) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot addTransceiver after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('addTransceiver()')\n\n    if (this.initiator) {\n      try {\n        this._pc.addTransceiver(kind, init)\n        this._needsNegotiation()\n      } catch (err) {\n        this.destroy(errCode(err, 'ERR_ADD_TRANSCEIVER'))\n      }\n    } else {\n      this.emit('signal', { // request initiator to renegotiate\n        type: 'transceiverRequest',\n        transceiverRequest: { kind, init }\n      })\n    }\n  }\n\n  /**\n   * Add a MediaStream to the connection.\n   * @param {MediaStream} stream\n   */\n  addStream (stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot addStream after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('addStream()')\n\n    stream.getTracks().forEach(track => {\n      this.addTrack(track, stream)\n    })\n  }\n\n  /**\n   * Add a MediaStreamTrack to the connection.\n   * @param {MediaStreamTrack} track\n   * @param {MediaStream} stream\n   */\n  addTrack (track, stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot addTrack after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('addTrack()')\n\n    const submap = this._senderMap.get(track) || new Map() // nested Maps map [track, stream] to sender\n    let sender = submap.get(stream)\n    if (!sender) {\n      sender = this._pc.addTrack(track, stream)\n      submap.set(stream, sender)\n      this._senderMap.set(track, submap)\n      this._needsNegotiation()\n    } else if (sender.removed) {\n      throw errCode(new Error('Track has been removed. You should enable/disable tracks that you want to re-add.'), 'ERR_SENDER_REMOVED')\n    } else {\n      throw errCode(new Error('Track has already been added to that stream.'), 'ERR_SENDER_ALREADY_ADDED')\n    }\n  }\n\n  /**\n   * Replace a MediaStreamTrack by another in the connection.\n   * @param {MediaStreamTrack} oldTrack\n   * @param {MediaStreamTrack} newTrack\n   * @param {MediaStream} stream\n   */\n  replaceTrack (oldTrack, newTrack, stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot replaceTrack after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('replaceTrack()')\n\n    const submap = this._senderMap.get(oldTrack)\n    const sender = submap ? submap.get(stream) : null\n    if (!sender) {\n      throw errCode(new Error('Cannot replace track that was never added.'), 'ERR_TRACK_NOT_ADDED')\n    }\n    if (newTrack) this._senderMap.set(newTrack, submap)\n\n    if (sender.replaceTrack != null) {\n      sender.replaceTrack(newTrack)\n    } else {\n      this.destroy(errCode(new Error('replaceTrack is not supported in this browser'), 'ERR_UNSUPPORTED_REPLACETRACK'))\n    }\n  }\n\n  /**\n   * Remove a MediaStreamTrack from the connection.\n   * @param {MediaStreamTrack} track\n   * @param {MediaStream} stream\n   */\n  removeTrack (track, stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot removeTrack after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('removeSender()')\n\n    const submap = this._senderMap.get(track)\n    const sender = submap ? submap.get(stream) : null\n    if (!sender) {\n      throw errCode(new Error('Cannot remove track that was never added.'), 'ERR_TRACK_NOT_ADDED')\n    }\n    try {\n      sender.removed = true\n      this._pc.removeTrack(sender)\n    } catch (err) {\n      if (err.name === 'NS_ERROR_UNEXPECTED') {\n        this._sendersAwaitingStable.push(sender) // HACK: Firefox must wait until (signalingState === stable) https://bugzilla.mozilla.org/show_bug.cgi?id=1133874\n      } else {\n        this.destroy(errCode(err, 'ERR_REMOVE_TRACK'))\n      }\n    }\n    this._needsNegotiation()\n  }\n\n  /**\n   * Remove a MediaStream from the connection.\n   * @param {MediaStream} stream\n   */\n  removeStream (stream) {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot removeStream after peer is destroyed'), 'ERR_DESTROYED')\n    this._debug('removeSenders()')\n\n    stream.getTracks().forEach(track => {\n      this.removeTrack(track, stream)\n    })\n  }\n\n  _needsNegotiation () {\n    this._debug('_needsNegotiation')\n    if (this._batchedNegotiation) return // batch synchronous renegotiations\n    this._batchedNegotiation = true\n    queueMicrotask(() => {\n      this._batchedNegotiation = false\n      if (this.initiator || !this._firstNegotiation) {\n        this._debug('starting batched negotiation')\n        this.negotiate()\n      } else {\n        this._debug('non-initiator initial negotiation request discarded')\n      }\n      this._firstNegotiation = false\n    })\n  }\n\n  negotiate () {\n    if (this.destroying) return\n    if (this.destroyed) throw errCode(new Error('cannot negotiate after peer is destroyed'), 'ERR_DESTROYED')\n\n    if (this.initiator) {\n      if (this._isNegotiating) {\n        this._queuedNegotiation = true\n        this._debug('already negotiating, queueing')\n      } else {\n        this._debug('start negotiation')\n        setTimeout(() => { // HACK: Chrome crashes if we immediately call createOffer\n          this._createOffer()\n        }, 0)\n      }\n    } else {\n      if (this._isNegotiating) {\n        this._queuedNegotiation = true\n        this._debug('already negotiating, queueing')\n      } else {\n        this._debug('requesting negotiation from initiator')\n        this.emit('signal', { // request initiator to renegotiate\n          type: 'renegotiate',\n          renegotiate: true\n        })\n      }\n    }\n    this._isNegotiating = true\n  }\n\n  // TODO: Delete this method once readable-stream is updated to contain a default\n  // implementation of destroy() that automatically calls _destroy()\n  // See: https://github.com/nodejs/readable-stream/issues/283\n  destroy (err) {\n    this._destroy(err, () => {})\n  }\n\n  _destroy (err, cb) {\n    if (this.destroyed || this.destroying) return\n    this.destroying = true\n\n    this._debug('destroying (error: %s)', err && (err.message || err))\n\n    queueMicrotask(() => { // allow events concurrent with the call to _destroy() to fire (see #692)\n      this.destroyed = true\n      this.destroying = false\n\n      this._debug('destroy (error: %s)', err && (err.message || err))\n\n      this.readable = this.writable = false\n\n      if (!this._readableState.ended) this.push(null)\n      if (!this._writableState.finished) this.end()\n\n      this._connected = false\n      this._pcReady = false\n      this._channelReady = false\n      this._remoteTracks = null\n      this._remoteStreams = null\n      this._senderMap = null\n\n      clearInterval(this._closingInterval)\n      this._closingInterval = null\n\n      clearInterval(this._interval)\n      this._interval = null\n      this._chunk = null\n      this._cb = null\n\n      if (this._onFinishBound) this.removeListener('finish', this._onFinishBound)\n      this._onFinishBound = null\n\n      if (this._channel) {\n        try {\n          this._channel.close()\n        } catch (err) {}\n\n        // allow events concurrent with destruction to be handled\n        this._channel.onmessage = null\n        this._channel.onopen = null\n        this._channel.onclose = null\n        this._channel.onerror = null\n      }\n      if (this._pc) {\n        try {\n          this._pc.close()\n        } catch (err) {}\n\n        // allow events concurrent with destruction to be handled\n        this._pc.oniceconnectionstatechange = null\n        this._pc.onicegatheringstatechange = null\n        this._pc.onsignalingstatechange = null\n        this._pc.onicecandidate = null\n        this._pc.ontrack = null\n        this._pc.ondatachannel = null\n      }\n      this._pc = null\n      this._channel = null\n\n      if (err) this.emit('error', err)\n      this.emit('close')\n      cb()\n    })\n  }\n\n  _setupData (event) {\n    if (!event.channel) {\n      // In some situations `pc.createDataChannel()` returns `undefined` (in wrtc),\n      // which is invalid behavior. Handle it gracefully.\n      // See: https://github.com/feross/simple-peer/issues/163\n      return this.destroy(errCode(new Error('Data channel event is missing `channel` property'), 'ERR_DATA_CHANNEL'))\n    }\n\n    this._channel = event.channel\n    this._channel.binaryType = 'arraybuffer'\n\n    if (typeof this._channel.bufferedAmountLowThreshold === 'number') {\n      this._channel.bufferedAmountLowThreshold = MAX_BUFFERED_AMOUNT\n    }\n\n    this.channelName = this._channel.label\n\n    this._channel.onmessage = event => {\n      this._onChannelMessage(event)\n    }\n    this._channel.onbufferedamountlow = () => {\n      this._onChannelBufferedAmountLow()\n    }\n    this._channel.onopen = () => {\n      this._onChannelOpen()\n    }\n    this._channel.onclose = () => {\n      this._onChannelClose()\n    }\n    this._channel.onerror = event => {\n      const err = event.error instanceof Error\n        ? event.error\n        : new Error(`Datachannel error: ${event.message} ${event.filename}:${event.lineno}:${event.colno}`)\n      this.destroy(errCode(err, 'ERR_DATA_CHANNEL'))\n    }\n\n    // HACK: Chrome will sometimes get stuck in readyState \"closing\", let's check for this condition\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=882743\n    let isClosing = false\n    this._closingInterval = setInterval(() => { // No \"onclosing\" event\n      if (this._channel && this._channel.readyState === 'closing') {\n        if (isClosing) this._onChannelClose() // closing timed out: equivalent to onclose firing\n        isClosing = true\n      } else {\n        isClosing = false\n      }\n    }, CHANNEL_CLOSING_TIMEOUT)\n  }\n\n  _read () {}\n\n  _write (chunk, encoding, cb) {\n    if (this.destroyed) return cb(errCode(new Error('cannot write after peer is destroyed'), 'ERR_DATA_CHANNEL'))\n\n    if (this._connected) {\n      try {\n        this.send(chunk)\n      } catch (err) {\n        return this.destroy(errCode(err, 'ERR_DATA_CHANNEL'))\n      }\n      if (this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT) {\n        this._debug('start backpressure: bufferedAmount %d', this._channel.bufferedAmount)\n        this._cb = cb\n      } else {\n        cb(null)\n      }\n    } else {\n      this._debug('write before connect')\n      this._chunk = chunk\n      this._cb = cb\n    }\n  }\n\n  // When stream finishes writing, close socket. Half open connections are not\n  // supported.\n  _onFinish () {\n    if (this.destroyed) return\n\n    // Wait a bit before destroying so the socket flushes.\n    // TODO: is there a more reliable way to accomplish this?\n    const destroySoon = () => {\n      setTimeout(() => this.destroy(), 1000)\n    }\n\n    if (this._connected) {\n      destroySoon()\n    } else {\n      this.once('connect', destroySoon)\n    }\n  }\n\n  _startIceCompleteTimeout () {\n    if (this.destroyed) return\n    if (this._iceCompleteTimer) return\n    this._debug('started iceComplete timeout')\n    this._iceCompleteTimer = setTimeout(() => {\n      if (!this._iceComplete) {\n        this._iceComplete = true\n        this._debug('iceComplete timeout completed')\n        this.emit('iceTimeout')\n        this.emit('_iceComplete')\n      }\n    }, this.iceCompleteTimeout)\n  }\n\n  _createOffer () {\n    if (this.destroyed) return\n\n    this._pc.createOffer(this.offerOptions)\n      .then(offer => {\n        if (this.destroyed) return\n        if (!this.trickle && !this.allowHalfTrickle) offer.sdp = filterTrickle(offer.sdp)\n        offer.sdp = this.sdpTransform(offer.sdp)\n\n        const sendOffer = () => {\n          if (this.destroyed) return\n          const signal = this._pc.localDescription || offer\n          this._debug('signal')\n          this.emit('signal', {\n            type: signal.type,\n            sdp: signal.sdp\n          })\n        }\n\n        const onSuccess = () => {\n          this._debug('createOffer success')\n          if (this.destroyed) return\n          if (this.trickle || this._iceComplete) sendOffer()\n          else this.once('_iceComplete', sendOffer) // wait for candidates\n        }\n\n        const onError = err => {\n          this.destroy(errCode(err, 'ERR_SET_LOCAL_DESCRIPTION'))\n        }\n\n        this._pc.setLocalDescription(offer)\n          .then(onSuccess)\n          .catch(onError)\n      })\n      .catch(err => {\n        this.destroy(errCode(err, 'ERR_CREATE_OFFER'))\n      })\n  }\n\n  _requestMissingTransceivers () {\n    if (this._pc.getTransceivers) {\n      this._pc.getTransceivers().forEach(transceiver => {\n        if (!transceiver.mid && transceiver.sender.track && !transceiver.requested) {\n          transceiver.requested = true // HACK: Safari returns negotiated transceivers with a null mid\n          this.addTransceiver(transceiver.sender.track.kind)\n        }\n      })\n    }\n  }\n\n  _createAnswer () {\n    if (this.destroyed) return\n\n    this._pc.createAnswer(this.answerOptions)\n      .then(answer => {\n        if (this.destroyed) return\n        if (!this.trickle && !this.allowHalfTrickle) answer.sdp = filterTrickle(answer.sdp)\n        answer.sdp = this.sdpTransform(answer.sdp)\n\n        const sendAnswer = () => {\n          if (this.destroyed) return\n          const signal = this._pc.localDescription || answer\n          this._debug('signal')\n          this.emit('signal', {\n            type: signal.type,\n            sdp: signal.sdp\n          })\n          if (!this.initiator) this._requestMissingTransceivers()\n        }\n\n        const onSuccess = () => {\n          if (this.destroyed) return\n          if (this.trickle || this._iceComplete) sendAnswer()\n          else this.once('_iceComplete', sendAnswer)\n        }\n\n        const onError = err => {\n          this.destroy(errCode(err, 'ERR_SET_LOCAL_DESCRIPTION'))\n        }\n\n        this._pc.setLocalDescription(answer)\n          .then(onSuccess)\n          .catch(onError)\n      })\n      .catch(err => {\n        this.destroy(errCode(err, 'ERR_CREATE_ANSWER'))\n      })\n  }\n\n  _onConnectionStateChange () {\n    if (this.destroyed) return\n    if (this._pc.connectionState === 'failed') {\n      this.destroy(errCode(new Error('Connection failed.'), 'ERR_CONNECTION_FAILURE'))\n    }\n  }\n\n  _onIceStateChange () {\n    if (this.destroyed) return\n    const iceConnectionState = this._pc.iceConnectionState\n    const iceGatheringState = this._pc.iceGatheringState\n\n    this._debug(\n      'iceStateChange (connection: %s) (gathering: %s)',\n      iceConnectionState,\n      iceGatheringState\n    )\n    this.emit('iceStateChange', iceConnectionState, iceGatheringState)\n\n    if (iceConnectionState === 'connected' || iceConnectionState === 'completed') {\n      this._pcReady = true\n      this._maybeReady()\n    }\n    if (iceConnectionState === 'failed') {\n      this.destroy(errCode(new Error('Ice connection failed.'), 'ERR_ICE_CONNECTION_FAILURE'))\n    }\n    if (iceConnectionState === 'closed') {\n      this.destroy(errCode(new Error('Ice connection closed.'), 'ERR_ICE_CONNECTION_CLOSED'))\n    }\n  }\n\n  getStats (cb) {\n    // statreports can come with a value array instead of properties\n    const flattenValues = report => {\n      if (Object.prototype.toString.call(report.values) === '[object Array]') {\n        report.values.forEach(value => {\n          Object.assign(report, value)\n        })\n      }\n      return report\n    }\n\n    // Promise-based getStats() (standard)\n    if (this._pc.getStats.length === 0 || this._isReactNativeWebrtc) {\n      this._pc.getStats()\n        .then(res => {\n          const reports = []\n          res.forEach(report => {\n            reports.push(flattenValues(report))\n          })\n          cb(null, reports)\n        }, err => cb(err))\n\n    // Single-parameter callback-based getStats() (non-standard)\n    } else if (this._pc.getStats.length > 0) {\n      this._pc.getStats(res => {\n        // If we destroy connection in `connect` callback this code might happen to run when actual connection is already closed\n        if (this.destroyed) return\n\n        const reports = []\n        res.result().forEach(result => {\n          const report = {}\n          result.names().forEach(name => {\n            report[name] = result.stat(name)\n          })\n          report.id = result.id\n          report.type = result.type\n          report.timestamp = result.timestamp\n          reports.push(flattenValues(report))\n        })\n        cb(null, reports)\n      }, err => cb(err))\n\n    // Unknown browser, skip getStats() since it's anyone's guess which style of\n    // getStats() they implement.\n    } else {\n      cb(null, [])\n    }\n  }\n\n  _maybeReady () {\n    this._debug('maybeReady pc %s channel %s', this._pcReady, this._channelReady)\n    if (this._connected || this._connecting || !this._pcReady || !this._channelReady) return\n\n    this._connecting = true\n\n    // HACK: We can't rely on order here, for details see https://github.com/js-platform/node-webrtc/issues/339\n    const findCandidatePair = () => {\n      if (this.destroyed) return\n\n      this.getStats((err, items) => {\n        if (this.destroyed) return\n\n        // Treat getStats error as non-fatal. It's not essential.\n        if (err) items = []\n\n        const remoteCandidates = {}\n        const localCandidates = {}\n        const candidatePairs = {}\n        let foundSelectedCandidatePair = false\n\n        items.forEach(item => {\n          // TODO: Once all browsers support the hyphenated stats report types, remove\n          // the non-hypenated ones\n          if (item.type === 'remotecandidate' || item.type === 'remote-candidate') {\n            remoteCandidates[item.id] = item\n          }\n          if (item.type === 'localcandidate' || item.type === 'local-candidate') {\n            localCandidates[item.id] = item\n          }\n          if (item.type === 'candidatepair' || item.type === 'candidate-pair') {\n            candidatePairs[item.id] = item\n          }\n        })\n\n        const setSelectedCandidatePair = selectedCandidatePair => {\n          foundSelectedCandidatePair = true\n\n          let local = localCandidates[selectedCandidatePair.localCandidateId]\n\n          if (local && (local.ip || local.address)) {\n            // Spec\n            this.localAddress = local.ip || local.address\n            this.localPort = Number(local.port)\n          } else if (local && local.ipAddress) {\n            // Firefox\n            this.localAddress = local.ipAddress\n            this.localPort = Number(local.portNumber)\n          } else if (typeof selectedCandidatePair.googLocalAddress === 'string') {\n            // TODO: remove this once Chrome 58 is released\n            local = selectedCandidatePair.googLocalAddress.split(':')\n            this.localAddress = local[0]\n            this.localPort = Number(local[1])\n          }\n          if (this.localAddress) {\n            this.localFamily = this.localAddress.includes(':') ? 'IPv6' : 'IPv4'\n          }\n\n          let remote = remoteCandidates[selectedCandidatePair.remoteCandidateId]\n\n          if (remote && (remote.ip || remote.address)) {\n            // Spec\n            this.remoteAddress = remote.ip || remote.address\n            this.remotePort = Number(remote.port)\n          } else if (remote && remote.ipAddress) {\n            // Firefox\n            this.remoteAddress = remote.ipAddress\n            this.remotePort = Number(remote.portNumber)\n          } else if (typeof selectedCandidatePair.googRemoteAddress === 'string') {\n            // TODO: remove this once Chrome 58 is released\n            remote = selectedCandidatePair.googRemoteAddress.split(':')\n            this.remoteAddress = remote[0]\n            this.remotePort = Number(remote[1])\n          }\n          if (this.remoteAddress) {\n            this.remoteFamily = this.remoteAddress.includes(':') ? 'IPv6' : 'IPv4'\n          }\n\n          this._debug(\n            'connect local: %s:%s remote: %s:%s',\n            this.localAddress,\n            this.localPort,\n            this.remoteAddress,\n            this.remotePort\n          )\n        }\n\n        items.forEach(item => {\n          // Spec-compliant\n          if (item.type === 'transport' && item.selectedCandidatePairId) {\n            setSelectedCandidatePair(candidatePairs[item.selectedCandidatePairId])\n          }\n\n          // Old implementations\n          if (\n            (item.type === 'googCandidatePair' && item.googActiveConnection === 'true') ||\n            ((item.type === 'candidatepair' || item.type === 'candidate-pair') && item.selected)\n          ) {\n            setSelectedCandidatePair(item)\n          }\n        })\n\n        // Ignore candidate pair selection in browsers like Safari 11 that do not have any local or remote candidates\n        // But wait until at least 1 candidate pair is available\n        if (!foundSelectedCandidatePair && (!Object.keys(candidatePairs).length || Object.keys(localCandidates).length)) {\n          setTimeout(findCandidatePair, 100)\n          return\n        } else {\n          this._connecting = false\n          this._connected = true\n        }\n\n        if (this._chunk) {\n          try {\n            this.send(this._chunk)\n          } catch (err) {\n            return this.destroy(errCode(err, 'ERR_DATA_CHANNEL'))\n          }\n          this._chunk = null\n          this._debug('sent chunk from \"write before connect\"')\n\n          const cb = this._cb\n          this._cb = null\n          cb(null)\n        }\n\n        // If `bufferedAmountLowThreshold` and 'onbufferedamountlow' are unsupported,\n        // fallback to using setInterval to implement backpressure.\n        if (typeof this._channel.bufferedAmountLowThreshold !== 'number') {\n          this._interval = setInterval(() => this._onInterval(), 150)\n          if (this._interval.unref) this._interval.unref()\n        }\n\n        this._debug('connect')\n        this.emit('connect')\n      })\n    }\n    findCandidatePair()\n  }\n\n  _onInterval () {\n    if (!this._cb || !this._channel || this._channel.bufferedAmount > MAX_BUFFERED_AMOUNT) {\n      return\n    }\n    this._onChannelBufferedAmountLow()\n  }\n\n  _onSignalingStateChange () {\n    if (this.destroyed) return\n\n    if (this._pc.signalingState === 'stable') {\n      this._isNegotiating = false\n\n      // HACK: Firefox doesn't yet support removing tracks when signalingState !== 'stable'\n      this._debug('flushing sender queue', this._sendersAwaitingStable)\n      this._sendersAwaitingStable.forEach(sender => {\n        this._pc.removeTrack(sender)\n        this._queuedNegotiation = true\n      })\n      this._sendersAwaitingStable = []\n\n      if (this._queuedNegotiation) {\n        this._debug('flushing negotiation queue')\n        this._queuedNegotiation = false\n        this._needsNegotiation() // negotiate again\n      } else {\n        this._debug('negotiated')\n        this.emit('negotiated')\n      }\n    }\n\n    this._debug('signalingStateChange %s', this._pc.signalingState)\n    this.emit('signalingStateChange', this._pc.signalingState)\n  }\n\n  _onIceCandidate (event) {\n    if (this.destroyed) return\n    if (event.candidate && this.trickle) {\n      this.emit('signal', {\n        type: 'candidate',\n        candidate: {\n          candidate: event.candidate.candidate,\n          sdpMLineIndex: event.candidate.sdpMLineIndex,\n          sdpMid: event.candidate.sdpMid\n        }\n      })\n    } else if (!event.candidate && !this._iceComplete) {\n      this._iceComplete = true\n      this.emit('_iceComplete')\n    }\n    // as soon as we've received one valid candidate start timeout\n    if (event.candidate) {\n      this._startIceCompleteTimeout()\n    }\n  }\n\n  _onChannelMessage (event) {\n    if (this.destroyed) return\n    let data = event.data\n    if (data instanceof ArrayBuffer) data = Buffer.from(data)\n    this.push(data)\n  }\n\n  _onChannelBufferedAmountLow () {\n    if (this.destroyed || !this._cb) return\n    this._debug('ending backpressure: bufferedAmount %d', this._channel.bufferedAmount)\n    const cb = this._cb\n    this._cb = null\n    cb(null)\n  }\n\n  _onChannelOpen () {\n    if (this._connected || this.destroyed) return\n    this._debug('on channel open')\n    this._channelReady = true\n    this._maybeReady()\n  }\n\n  _onChannelClose () {\n    if (this.destroyed) return\n    this._debug('on channel close')\n    this.destroy()\n  }\n\n  _onTrack (event) {\n    if (this.destroyed) return\n\n    event.streams.forEach(eventStream => {\n      this._debug('on track')\n      this.emit('track', event.track, eventStream)\n\n      this._remoteTracks.push({\n        track: event.track,\n        stream: eventStream\n      })\n\n      if (this._remoteStreams.some(remoteStream => {\n        return remoteStream.id === eventStream.id\n      })) return // Only fire one 'stream' event, even though there may be multiple tracks per stream\n\n      this._remoteStreams.push(eventStream)\n      queueMicrotask(() => {\n        this._debug('on stream')\n        this.emit('stream', eventStream) // ensure all tracks have been added\n      })\n    })\n  }\n\n  _debug () {\n    const args = [].slice.call(arguments)\n    args[0] = '[' + this._id + '] ' + args[0]\n    debug.apply(null, args)\n  }\n}\n\nPeer.WEBRTC_SUPPORT = !!getBrowserRTC()\n\n/**\n * Expose peer and data channel config for overriding all Peer\n * instances. Otherwise, just set opts.config or opts.channelConfig\n * when constructing a Peer.\n */\nPeer.config = {\n  iceServers: [\n    {\n      urls: [\n        'stun:stun.l.google.com:19302',\n        'stun:global.stun.twilio.com:3478'\n      ]\n    }\n  ],\n  sdpSemantics: 'unified-plan'\n}\n\nPeer.channelConfig = {}\n\nmodule.exports = Peer\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\nexports.destroy = (() => {\n\tlet warned = false;\n\n\treturn () => {\n\t\tif (!warned) {\n\t\t\twarned = true;\n\t\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t\t}\n\t};\n})();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\tlet m;\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\t// eslint-disable-next-line no-return-assign\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && (m = navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)) && parseInt(m[1], 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n *\n * @api public\n */\nexports.log = console.debug || console.log || (() => {});\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug') || exports.storage.getItem('DEBUG') ;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\n/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\n// alternative to using Object.keys for old browsers\nfunction copyProps (src, dst) {\n  for (var key in src) {\n    dst[key] = src[key]\n  }\n}\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  copyProps(buffer, exports)\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.prototype = Object.create(Buffer.prototype)\n\n// Copy static methods from Buffer\ncopyProps(Buffer, SafeBuffer)\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","'use strict';\n\n// undocumented cb() API, needed for core, not for public API\nfunction destroy(err, cb) {\n  var _this = this;\n  var readableDestroyed = this._readableState && this._readableState.destroyed;\n  var writableDestroyed = this._writableState && this._writableState.destroyed;\n  if (readableDestroyed || writableDestroyed) {\n    if (cb) {\n      cb(err);\n    } else if (err) {\n      if (!this._writableState) {\n        process.nextTick(emitErrorNT, this, err);\n      } else if (!this._writableState.errorEmitted) {\n        this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorNT, this, err);\n      }\n    }\n    return this;\n  }\n\n  // we set destroyed to true before firing error callbacks in order\n  // to make it re-entrance safe in case destroy() is called within callbacks\n\n  if (this._readableState) {\n    this._readableState.destroyed = true;\n  }\n\n  // if this is a duplex stream mark the writable part as destroyed as well\n  if (this._writableState) {\n    this._writableState.destroyed = true;\n  }\n  this._destroy(err || null, function (err) {\n    if (!cb && err) {\n      if (!_this._writableState) {\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else if (!_this._writableState.errorEmitted) {\n        _this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else {\n        process.nextTick(emitCloseNT, _this);\n      }\n    } else if (cb) {\n      process.nextTick(emitCloseNT, _this);\n      cb(err);\n    } else {\n      process.nextTick(emitCloseNT, _this);\n    }\n  });\n  return this;\n}\nfunction emitErrorAndCloseNT(self, err) {\n  emitErrorNT(self, err);\n  emitCloseNT(self);\n}\nfunction emitCloseNT(self) {\n  if (self._writableState && !self._writableState.emitClose) return;\n  if (self._readableState && !self._readableState.emitClose) return;\n  self.emit('close');\n}\nfunction undestroy() {\n  if (this._readableState) {\n    this._readableState.destroyed = false;\n    this._readableState.reading = false;\n    this._readableState.ended = false;\n    this._readableState.endEmitted = false;\n  }\n  if (this._writableState) {\n    this._writableState.destroyed = false;\n    this._writableState.ended = false;\n    this._writableState.ending = false;\n    this._writableState.finalCalled = false;\n    this._writableState.prefinished = false;\n    this._writableState.finished = false;\n    this._writableState.errorEmitted = false;\n  }\n}\nfunction emitErrorNT(self, err) {\n  self.emit('error', err);\n}\nfunction errorOrDestroy(stream, err) {\n  // We have tests that rely on errors being emitted\n  // in the same tick, so changing this is semver major.\n  // For now when you opt-in to autoDestroy we allow\n  // the error to be emitted nextTick. In a future\n  // semver major update we should change the default to this.\n\n  var rState = stream._readableState;\n  var wState = stream._writableState;\n  if (rState && rState.autoDestroy || wState && wState.autoDestroy) stream.destroy(err);else stream.emit('error', err);\n}\nmodule.exports = {\n  destroy: destroy,\n  undestroy: undestroy,\n  errorOrDestroy: errorOrDestroy\n};","'use strict';\n\nvar _Object$setPrototypeO;\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar finished = require('./end-of-stream');\nvar kLastResolve = Symbol('lastResolve');\nvar kLastReject = Symbol('lastReject');\nvar kError = Symbol('error');\nvar kEnded = Symbol('ended');\nvar kLastPromise = Symbol('lastPromise');\nvar kHandlePromise = Symbol('handlePromise');\nvar kStream = Symbol('stream');\nfunction createIterResult(value, done) {\n  return {\n    value: value,\n    done: done\n  };\n}\nfunction readAndResolve(iter) {\n  var resolve = iter[kLastResolve];\n  if (resolve !== null) {\n    var data = iter[kStream].read();\n    // we defer if data is null\n    // we can be expecting either 'end' or\n    // 'error'\n    if (data !== null) {\n      iter[kLastPromise] = null;\n      iter[kLastResolve] = null;\n      iter[kLastReject] = null;\n      resolve(createIterResult(data, false));\n    }\n  }\n}\nfunction onReadable(iter) {\n  // we wait for the next tick, because it might\n  // emit an error with process.nextTick\n  process.nextTick(readAndResolve, iter);\n}\nfunction wrapForNext(lastPromise, iter) {\n  return function (resolve, reject) {\n    lastPromise.then(function () {\n      if (iter[kEnded]) {\n        resolve(createIterResult(undefined, true));\n        return;\n      }\n      iter[kHandlePromise](resolve, reject);\n    }, reject);\n  };\n}\nvar AsyncIteratorPrototype = Object.getPrototypeOf(function () {});\nvar ReadableStreamAsyncIteratorPrototype = Object.setPrototypeOf((_Object$setPrototypeO = {\n  get stream() {\n    return this[kStream];\n  },\n  next: function next() {\n    var _this = this;\n    // if we have detected an error in the meanwhile\n    // reject straight away\n    var error = this[kError];\n    if (error !== null) {\n      return Promise.reject(error);\n    }\n    if (this[kEnded]) {\n      return Promise.resolve(createIterResult(undefined, true));\n    }\n    if (this[kStream].destroyed) {\n      // We need to defer via nextTick because if .destroy(err) is\n      // called, the error will be emitted via nextTick, and\n      // we cannot guarantee that there is no error lingering around\n      // waiting to be emitted.\n      return new Promise(function (resolve, reject) {\n        process.nextTick(function () {\n          if (_this[kError]) {\n            reject(_this[kError]);\n          } else {\n            resolve(createIterResult(undefined, true));\n          }\n        });\n      });\n    }\n\n    // if we have multiple next() calls\n    // we will wait for the previous Promise to finish\n    // this logic is optimized to support for await loops,\n    // where next() is only called once at a time\n    var lastPromise = this[kLastPromise];\n    var promise;\n    if (lastPromise) {\n      promise = new Promise(wrapForNext(lastPromise, this));\n    } else {\n      // fast path needed to support multiple this.push()\n      // without triggering the next() queue\n      var data = this[kStream].read();\n      if (data !== null) {\n        return Promise.resolve(createIterResult(data, false));\n      }\n      promise = new Promise(this[kHandlePromise]);\n    }\n    this[kLastPromise] = promise;\n    return promise;\n  }\n}, _defineProperty(_Object$setPrototypeO, Symbol.asyncIterator, function () {\n  return this;\n}), _defineProperty(_Object$setPrototypeO, \"return\", function _return() {\n  var _this2 = this;\n  // destroy(err, cb) is a private API\n  // we can guarantee we have that here, because we control the\n  // Readable class this is attached to\n  return new Promise(function (resolve, reject) {\n    _this2[kStream].destroy(null, function (err) {\n      if (err) {\n        reject(err);\n        return;\n      }\n      resolve(createIterResult(undefined, true));\n    });\n  });\n}), _Object$setPrototypeO), AsyncIteratorPrototype);\nvar createReadableStreamAsyncIterator = function createReadableStreamAsyncIterator(stream) {\n  var _Object$create;\n  var iterator = Object.create(ReadableStreamAsyncIteratorPrototype, (_Object$create = {}, _defineProperty(_Object$create, kStream, {\n    value: stream,\n    writable: true\n  }), _defineProperty(_Object$create, kLastResolve, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kLastReject, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kError, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kEnded, {\n    value: stream._readableState.endEmitted,\n    writable: true\n  }), _defineProperty(_Object$create, kHandlePromise, {\n    value: function value(resolve, reject) {\n      var data = iterator[kStream].read();\n      if (data) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        resolve(createIterResult(data, false));\n      } else {\n        iterator[kLastResolve] = resolve;\n        iterator[kLastReject] = reject;\n      }\n    },\n    writable: true\n  }), _Object$create));\n  iterator[kLastPromise] = null;\n  finished(stream, function (err) {\n    if (err && err.code !== 'ERR_STREAM_PREMATURE_CLOSE') {\n      var reject = iterator[kLastReject];\n      // reject if we are waiting for data in the Promise\n      // returned by next() and store the error\n      if (reject !== null) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        reject(err);\n      }\n      iterator[kError] = err;\n      return;\n    }\n    var resolve = iterator[kLastResolve];\n    if (resolve !== null) {\n      iterator[kLastPromise] = null;\n      iterator[kLastResolve] = null;\n      iterator[kLastReject] = null;\n      resolve(createIterResult(undefined, true));\n    }\n    iterator[kEnded] = true;\n  });\n  stream.on('readable', onReadable.bind(null, iterator));\n  return iterator;\n};\nmodule.exports = createReadableStreamAsyncIterator;","import { P2PConnection, SyncMessage } from '../p2p/connection';\n\nexport interface VideoState {\n  isPlaying: boolean;\n  position: number;\n  timestamp: number;\n}\n\nexport class SyncManager {\n  private connection: P2PConnection;\n  private isHost: boolean;\n  private videoElement: HTMLVideoElement | null = null;\n  private syncInterval: NodeJS.Timeout | null = null;\n  private onStateUpdateCallback: ((state: VideoState) => void) | null = null;\n  private videoDuration: number = 0;\n  private lastSyncTime: number = 0;\n  private driftThreshold = 0.3; // 300ms\n  private hardSeekThreshold = 0.7; // 700ms\n  private syncIntervalMs = 500; // Send sync every 500ms\n\n  constructor(connection: P2PConnection, isHost: boolean) {\n    this.connection = connection;\n    this.isHost = isHost;\n    this.setupMessageHandler();\n  }\n\n  /**\n   * Set the video element to control\n   */\n  setVideoElement(videoElement: HTMLVideoElement): void {\n    this.videoElement = videoElement;\n    this.videoDuration = videoElement.duration;\n\n    // Setup video event listeners\n    this.setupVideoListeners();\n\n    // Start sync loop if host\n    if (this.isHost) {\n      this.startSyncLoop();\n    }\n  }\n\n  /**\n   * Setup video element event listeners\n   */\n  private setupVideoListeners(): void {\n    if (!this.videoElement) return;\n\n    this.videoElement.addEventListener('play', () => {\n      this.handleLocalPlay();\n    });\n\n    this.videoElement.addEventListener('pause', () => {\n      this.handleLocalPause();\n    });\n\n    this.videoElement.addEventListener('seeked', () => {\n      this.handleLocalSeek();\n    });\n\n    this.videoElement.addEventListener('loadedmetadata', () => {\n      if (this.videoElement) {\n        this.videoDuration = this.videoElement.duration;\n        console.log('Video duration:', this.videoDuration);\n      }\n    });\n  }\n\n  /**\n   * Handle local play event\n   */\n  private handleLocalPlay(): void {\n    if (!this.videoElement) return;\n\n    const message: SyncMessage = {\n      type: 'play',\n      isPlaying: true,\n      position: this.videoElement.currentTime,\n      timestamp: Date.now(),\n    };\n\n    if (this.isHost) {\n      this.connection.broadcast(message);\n    } else {\n      this.connection.sendMessage(message);\n    }\n  }\n\n  /**\n   * Handle local pause event\n   */\n  private handleLocalPause(): void {\n    if (!this.videoElement) return;\n\n    const message: SyncMessage = {\n      type: 'pause',\n      isPlaying: false,\n      position: this.videoElement.currentTime,\n      timestamp: Date.now(),\n    };\n\n    if (this.isHost) {\n      this.connection.broadcast(message);\n    } else {\n      this.connection.sendMessage(message);\n    }\n  }\n\n  /**\n   * Handle local seek event\n   */\n  private handleLocalSeek(): void {\n    if (!this.videoElement) return;\n\n    const message: SyncMessage = {\n      type: 'seek',\n      position: this.videoElement.currentTime,\n      isPlaying: !this.videoElement.paused,\n      timestamp: Date.now(),\n    };\n\n    if (this.isHost) {\n      this.connection.broadcast(message);\n    } else {\n      this.connection.sendMessage(message);\n    }\n  }\n\n  /**\n   * Setup message handler for incoming sync messages\n   */\n  private setupMessageHandler(): void {\n    this.connection.onMessage((message: SyncMessage) => {\n      this.handleSyncMessage(message);\n    });\n  }\n\n  /**\n   * Handle incoming sync message\n   */\n  private handleSyncMessage(message: SyncMessage): void {\n    if (!this.videoElement) return;\n\n    switch (message.type) {\n      case 'play':\n        this.applyPlay(message);\n        break;\n      case 'pause':\n        this.applyPause(message);\n        break;\n      case 'seek':\n        this.applySeek(message);\n        break;\n      case 'sync':\n        this.applySync(message);\n        break;\n      case 'ready':\n        console.log('Peer ready:', message.userId);\n        break;\n      case 'join':\n        console.log('Peer joined:', message.userId);\n        // If we're the host, send current state\n        if (this.isHost) {\n          this.sendCurrentState();\n        }\n        break;\n    }\n  }\n\n  /**\n   * Apply play command\n   */\n  private async applyPlay(message: SyncMessage): Promise<void> {\n    if (!this.videoElement || message.position === undefined) return;\n\n    // Sync position first\n    const drift = Math.abs(this.videoElement.currentTime - message.position);\n    if (drift > this.driftThreshold) {\n      this.videoElement.currentTime = message.position;\n    }\n\n    // Play\n    if (this.videoElement.paused) {\n      try {\n        await this.videoElement.play();\n      } catch (error) {\n        console.error('Error playing video:', error);\n      }\n    }\n  }\n\n  /**\n   * Apply pause command\n   */\n  private applyPause(message: SyncMessage): void {\n    if (!this.videoElement || message.position === undefined) return;\n\n    // Sync position\n    const drift = Math.abs(this.videoElement.currentTime - message.position);\n    if (drift > this.driftThreshold) {\n      this.videoElement.currentTime = message.position;\n    }\n\n    // Pause\n    if (!this.videoElement.paused) {\n      this.videoElement.pause();\n    }\n  }\n\n  /**\n   * Apply seek command\n   */\n  private applySeek(message: SyncMessage): void {\n    if (!this.videoElement || message.position === undefined) return;\n\n    this.videoElement.currentTime = message.position;\n\n    if (message.isPlaying && this.videoElement.paused) {\n      this.videoElement.play().catch((error) => {\n        console.error('Error playing after seek:', error);\n      });\n    } else if (!message.isPlaying && !this.videoElement.paused) {\n      this.videoElement.pause();\n    }\n  }\n\n  /**\n   * Apply sync update (drift correction)\n   */\n  private applySync(message: SyncMessage): void {\n    if (\n      !this.videoElement ||\n      message.position === undefined ||\n      message.isPlaying === undefined ||\n      message.timestamp === undefined\n    ) {\n      return;\n    }\n\n    // Don't apply sync if we just received one recently (avoid feedback loop)\n    const now = Date.now();\n    if (now - this.lastSyncTime < 200) {\n      return;\n    }\n    this.lastSyncTime = now;\n\n    // Calculate expected position based on elapsed time since message\n    const elapsed = (now - message.timestamp) / 1000;\n    const expectedPosition = message.isPlaying\n      ? message.position + elapsed\n      : message.position;\n\n    // Calculate drift\n    const drift = Math.abs(this.videoElement.currentTime - expectedPosition);\n\n    if (drift < this.driftThreshold) {\n      // Small drift - no correction needed\n      return;\n    } else if (drift < this.hardSeekThreshold) {\n      // Medium drift - micro-adjust playback rate\n      if (message.isPlaying) {\n        const adjustment = drift > 0.5 ? 0.05 : 0.02;\n        this.videoElement.playbackRate =\n          this.videoElement.currentTime < expectedPosition\n            ? 1.0 + adjustment\n            : 1.0 - adjustment;\n\n        // Reset to normal speed after a short time\n        setTimeout(() => {\n          if (this.videoElement) {\n            this.videoElement.playbackRate = 1.0;\n          }\n        }, 1000);\n      }\n    } else {\n      // Large drift - hard seek\n      console.log(\n        `Large drift detected (${drift.toFixed(2)}s), hard seeking`\n      );\n      this.videoElement.currentTime = expectedPosition;\n    }\n\n    // Sync play/pause state\n    if (message.isPlaying && this.videoElement.paused) {\n      this.videoElement.play().catch((error) => {\n        console.error('Error playing during sync:', error);\n      });\n    } else if (!message.isPlaying && !this.videoElement.paused) {\n      this.videoElement.pause();\n    }\n  }\n\n  /**\n   * Start sync loop (host only)\n   */\n  private startSyncLoop(): void {\n    if (!this.isHost) return;\n\n    this.syncInterval = setInterval(() => {\n      this.sendSyncUpdate();\n    }, this.syncIntervalMs);\n  }\n\n  /**\n   * Send sync update to peers\n   */\n  private sendSyncUpdate(): void {\n    if (!this.videoElement || !this.isHost) return;\n\n    const message: SyncMessage = {\n      type: 'sync',\n      isPlaying: !this.videoElement.paused,\n      position: this.videoElement.currentTime,\n      timestamp: Date.now(),\n    };\n\n    this.connection.broadcast(message);\n  }\n\n  /**\n   * Send current state to new peer\n   */\n  private sendCurrentState(): void {\n    if (!this.videoElement || !this.isHost) return;\n\n    const message: SyncMessage = {\n      type: 'sync',\n      isPlaying: !this.videoElement.paused,\n      position: this.videoElement.currentTime,\n      timestamp: Date.now(),\n      videoDuration: this.videoDuration,\n    };\n\n    this.connection.broadcast(message);\n  }\n\n  /**\n   * Notify that we're ready to sync\n   */\n  notifyReady(userId: string): void {\n    const message: SyncMessage = {\n      type: 'ready',\n      userId: userId,\n      videoDuration: this.videoDuration,\n    };\n\n    this.connection.sendMessage(message);\n  }\n\n  /**\n   * Set callback for state updates\n   */\n  onStateUpdate(callback: (state: VideoState) => void): void {\n    this.onStateUpdateCallback = callback;\n  }\n\n  /**\n   * Cleanup\n   */\n  cleanup(): void {\n    if (this.syncInterval) {\n      clearInterval(this.syncInterval);\n      this.syncInterval = null;\n    }\n\n    this.videoElement = null;\n  }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// This file will be compiled and included in the renderer process\n// Import the necessary modules from the bundled code\n\nimport { P2PConnection, ConnectionStatus } from '../src/p2p/connection';\nimport { SyncManager } from '../src/sync/syncManager';\n\nclass LocalWatchApp {\n  private currentScreen: string = 'home';\n  private connection: P2PConnection | null = null;\n  private syncManager: SyncManager | null = null;\n  private isHost: boolean = false;\n  private selectedVideoPath: string | null = null;\n  private videoDuration: number = 0;\n  private userId: string;\n\n  constructor() {\n    this.userId = this.generateUserId();\n    this.initializeEventListeners();\n  }\n\n  private generateUserId(): string {\n    return `user_${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  private initializeEventListeners(): void {\n    // Home screen\n    document\n      .getElementById('create-room-btn')\n      ?.addEventListener('click', () => this.showCreateRoom());\n    document\n      .getElementById('join-room-btn')\n      ?.addEventListener('click', () => this.showJoinRoom());\n\n    // Create room\n    document\n      .getElementById('create-back-btn')\n      ?.addEventListener('click', () => this.showHome());\n    document\n      .getElementById('select-video-btn')\n      ?.addEventListener('click', () => this.selectVideo('host'));\n    document\n      .getElementById('copy-code-btn')\n      ?.addEventListener('click', () => this.copyRoomCode());\n    document\n      .getElementById('copy-signal-btn')\n      ?.addEventListener('click', () => this.copyHostSignal());\n    document\n      .getElementById('connect-guest-btn')\n      ?.addEventListener('click', () => this.connectGuest());\n    document\n      .getElementById('start-watching-btn')\n      ?.addEventListener('click', () => this.startWatching());\n\n    // Join room\n    document\n      .getElementById('join-back-btn')\n      ?.addEventListener('click', () => this.showHome());\n    document\n      .getElementById('join-select-video-btn')\n      ?.addEventListener('click', () => this.selectVideo('guest'));\n    document\n      .getElementById('copy-guest-signal-btn')\n      ?.addEventListener('click', () => this.copyGuestSignal());\n    document\n      .getElementById('join-room-connect-btn')\n      ?.addEventListener('click', () => this.joinRoom());\n\n    // Player\n    document\n      .getElementById('exit-player-btn')\n      ?.addEventListener('click', () => this.exitPlayer());\n    document\n      .getElementById('play-pause-btn')\n      ?.addEventListener('click', () => this.togglePlayPause());\n    document\n      .getElementById('fullscreen-btn')\n      ?.addEventListener('click', () => this.toggleFullscreen());\n\n    // Seek bar\n    const seekBar = document.getElementById('seek-bar') as HTMLInputElement;\n    seekBar?.addEventListener('input', () => this.handleSeekBarInput());\n    seekBar?.addEventListener('change', () => this.handleSeek());\n\n    // Error modal\n    document\n      .getElementById('error-ok-btn')\n      ?.addEventListener('click', () => this.hideError());\n  }\n\n  private showScreen(screenId: string): void {\n    document.querySelectorAll('.screen').forEach((screen) => {\n      screen.classList.remove('active');\n    });\n    document.getElementById(screenId)?.classList.add('active');\n    this.currentScreen = screenId;\n  }\n\n  private showHome(): void {\n    this.cleanup();\n    this.showScreen('home-screen');\n  }\n\n  private async showCreateRoom(): Promise<void> {\n    this.isHost = true;\n    this.showScreen('create-room-screen');\n  }\n\n  private showJoinRoom(): void {\n    this.isHost = false;\n    this.showScreen('join-room-screen');\n  }\n\n  private async selectVideo(mode: 'host' | 'guest'): Promise<void> {\n    try {\n      const filePath = await window.electronAPI.selectVideoFile();\n      if (!filePath) return;\n\n      this.selectedVideoPath = filePath;\n\n      // Display selected file\n      const displayElement = document.getElementById(\n        mode === 'host' ? 'video-selected' : 'join-video-selected'\n      );\n      if (displayElement) {\n        displayElement.textContent = `Selected: ${filePath.split('/').pop()}`;\n        displayElement.style.color = '#44ff44';\n      }\n\n      // If host, create room\n      if (mode === 'host') {\n        await this.createRoom();\n      }\n    } catch (error) {\n      this.showError(`Error selecting video: ${error}`);\n    }\n  }\n\n  private async createRoom(): Promise<void> {\n    try {\n      this.connection = new P2PConnection(true);\n      this.connection.onStatusChange((status) =>\n        this.handleConnectionStatus(status)\n      );\n\n      const roomCode = await this.connection.initAsHost();\n\n      // Display room code\n      const roomCodeElement = document.getElementById('room-code');\n      if (roomCodeElement) {\n        roomCodeElement.textContent = roomCode;\n      }\n\n      // Get and display signal\n      const signal = await this.connection.getSignalData();\n      const signalOutput = document.getElementById(\n        'host-signal-output'\n      ) as HTMLTextAreaElement;\n      if (signalOutput) {\n        signalOutput.value = signal;\n      }\n\n      // Show room code section\n      document.getElementById('room-code-section')!.style.display = 'block';\n    } catch (error) {\n      this.showError(`Error creating room: ${error}`);\n    }\n  }\n\n  private async connectGuest(): Promise<void> {\n    try {\n      const guestSignalInput = document.getElementById(\n        'guest-signal-input'\n      ) as HTMLTextAreaElement;\n      const guestSignal = guestSignalInput.value.trim();\n\n      if (!guestSignal) {\n        this.showError('Please paste the guest signal data');\n        return;\n      }\n\n      if (!this.connection) {\n        this.showError('Connection not initialized');\n        return;\n      }\n\n      await this.connection.connectWithGuest(guestSignal);\n\n      // Show waiting section\n      document.getElementById('waiting-section')!.style.display = 'block';\n      document.getElementById('room-code-section')!.style.display = 'none';\n\n      // Update connected count\n      const connectedCount = document.getElementById('connected-count');\n      if (connectedCount) {\n        connectedCount.textContent = '1';\n      }\n    } catch (error) {\n      this.showError(`Error connecting guest: ${error}`);\n    }\n  }\n\n  private async joinRoom(): Promise<void> {\n    try {\n      const roomCodeInput = document.getElementById(\n        'room-code-input'\n      ) as HTMLInputElement;\n      const roomCode = roomCodeInput.value.trim().toUpperCase();\n\n      if (!roomCode || roomCode.length !== 6) {\n        this.showError('Please enter a valid 6-character room code');\n        return;\n      }\n\n      if (!this.selectedVideoPath) {\n        this.showError('Please select a video file first');\n        return;\n      }\n\n      const hostSignalInput = document.getElementById(\n        'host-signal-input'\n      ) as HTMLTextAreaElement;\n      const hostSignal = hostSignalInput.value.trim();\n\n      if (!hostSignal) {\n        this.showError('Please paste the host signal data');\n        return;\n      }\n\n      // Create connection\n      this.connection = new P2PConnection(false);\n      this.connection.onStatusChange((status) =>\n        this.handleConnectionStatus(status)\n      );\n\n      // Join room\n      await this.connection.joinRoom(roomCode, hostSignal);\n\n      // Get guest signal\n      const guestSignal = await this.connection.getSignalData();\n      const guestSignalOutput = document.getElementById(\n        'guest-signal-output'\n      ) as HTMLTextAreaElement;\n      if (guestSignalOutput) {\n        guestSignalOutput.value = guestSignal;\n      }\n\n      const statusElement = document.getElementById('join-status');\n      if (statusElement) {\n        statusElement.textContent = 'Connected! Copy your signal and send it to the host, then start watching.';\n        statusElement.style.color = '#44ff44';\n      }\n\n      // Auto start watching after connection\n      setTimeout(() => {\n        this.startWatching();\n      }, 2000);\n    } catch (error) {\n      this.showError(`Error joining room: ${error}`);\n    }\n  }\n\n  private async startWatching(): Promise<void> {\n    if (!this.selectedVideoPath) {\n      this.showError('No video file selected');\n      return;\n    }\n\n    if (!this.connection || !this.connection.isConnected()) {\n      this.showError('Not connected to peer');\n      return;\n    }\n\n    try {\n      // Show player screen\n      this.showScreen('player-screen');\n\n      // Setup video player\n      const videoPlayer = document.getElementById(\n        'video-player'\n      ) as HTMLVideoElement;\n      if (!videoPlayer) {\n        throw new Error('Video player element not found');\n      }\n\n      // Load video\n      videoPlayer.src = `file://${this.selectedVideoPath}`;\n\n      // Wait for metadata\n      await new Promise((resolve, reject) => {\n        videoPlayer.onloadedmetadata = resolve;\n        videoPlayer.onerror = reject;\n      });\n\n      this.videoDuration = videoPlayer.duration;\n\n      // Initialize sync manager\n      this.syncManager = new SyncManager(this.connection, this.isHost);\n      this.syncManager.setVideoElement(videoPlayer);\n\n      // Setup player UI updates\n      videoPlayer.addEventListener('timeupdate', () => this.updateTimeDisplay());\n\n      // Display room code if host\n      if (this.isHost) {\n        const roomCodeDisplay = document.getElementById('room-code-display');\n        if (roomCodeDisplay && this.connection) {\n          roomCodeDisplay.textContent = `Room: ${this.connection.getRoomCode()}`;\n        }\n      }\n\n      // Notify ready\n      if (this.syncManager) {\n        this.syncManager.notifyReady(this.userId);\n      }\n    } catch (error) {\n      this.showError(`Error starting playback: ${error}`);\n    }\n  }\n\n  private togglePlayPause(): void {\n    const videoPlayer = document.getElementById(\n      'video-player'\n    ) as HTMLVideoElement;\n    const playPauseBtn = document.getElementById('play-pause-btn');\n\n    if (!videoPlayer || !playPauseBtn) return;\n\n    if (videoPlayer.paused) {\n      videoPlayer.play();\n      playPauseBtn.textContent = '';\n    } else {\n      videoPlayer.pause();\n      playPauseBtn.textContent = '';\n    }\n  }\n\n  private handleSeekBarInput(): void {\n    // Update time display while dragging\n    const seekBar = document.getElementById('seek-bar') as HTMLInputElement;\n    const videoPlayer = document.getElementById(\n      'video-player'\n    ) as HTMLVideoElement;\n\n    if (!seekBar || !videoPlayer) return;\n\n    const time = (parseFloat(seekBar.value) / 100) * this.videoDuration;\n    videoPlayer.currentTime = time;\n  }\n\n  private handleSeek(): void {\n    // Actual seek is handled by the input event\n    // This is called on mouseup\n  }\n\n  private updateTimeDisplay(): void {\n    const videoPlayer = document.getElementById(\n      'video-player'\n    ) as HTMLVideoElement;\n    const seekBar = document.getElementById('seek-bar') as HTMLInputElement;\n    const timeDisplay = document.getElementById('time-display');\n\n    if (!videoPlayer || !seekBar || !timeDisplay) return;\n\n    const currentTime = videoPlayer.currentTime;\n    const duration = this.videoDuration;\n\n    // Update seek bar\n    seekBar.value = ((currentTime / duration) * 100).toString();\n\n    // Update time display\n    timeDisplay.textContent = `${this.formatTime(currentTime)} / ${this.formatTime(duration)}`;\n  }\n\n  private formatTime(seconds: number): string {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  }\n\n  private toggleFullscreen(): void {\n    const playerContainer = document.querySelector('.player-container');\n    if (!playerContainer) return;\n\n    if (!document.fullscreenElement) {\n      playerContainer.requestFullscreen();\n    } else {\n      document.exitFullscreen();\n    }\n  }\n\n  private handleConnectionStatus(status: ConnectionStatus): void {\n    const statusDot = document.getElementById('connection-status');\n    const statusText = document.getElementById('connection-text');\n\n    if (!statusDot || !statusText) return;\n\n    switch (status) {\n      case 'connected':\n        statusDot.classList.add('connected');\n        statusText.textContent = 'Connected';\n        break;\n      case 'connecting':\n        statusDot.classList.remove('connected');\n        statusText.textContent = 'Connecting...';\n        break;\n      case 'disconnected':\n        statusDot.classList.remove('connected');\n        statusText.textContent = 'Disconnected';\n        break;\n      case 'error':\n        statusDot.classList.remove('connected');\n        statusText.textContent = 'Connection Error';\n        break;\n    }\n  }\n\n  private copyRoomCode(): void {\n    const roomCode = document.getElementById('room-code')?.textContent;\n    if (roomCode) {\n      navigator.clipboard.writeText(roomCode);\n      this.showSuccess('Room code copied!');\n    }\n  }\n\n  private copyHostSignal(): void {\n    const signalOutput = document.getElementById(\n      'host-signal-output'\n    ) as HTMLTextAreaElement;\n    if (signalOutput && signalOutput.value) {\n      navigator.clipboard.writeText(signalOutput.value);\n      this.showSuccess('Signal copied!');\n    }\n  }\n\n  private copyGuestSignal(): void {\n    const signalOutput = document.getElementById(\n      'guest-signal-output'\n    ) as HTMLTextAreaElement;\n    if (signalOutput && signalOutput.value) {\n      navigator.clipboard.writeText(signalOutput.value);\n      this.showSuccess('Signal copied!');\n    }\n  }\n\n  private exitPlayer(): void {\n    this.cleanup();\n    this.showHome();\n  }\n\n  private cleanup(): void {\n    if (this.syncManager) {\n      this.syncManager.cleanup();\n      this.syncManager = null;\n    }\n\n    if (this.connection) {\n      this.connection.disconnect();\n      this.connection = null;\n    }\n\n    const videoPlayer = document.getElementById(\n      'video-player'\n    ) as HTMLVideoElement;\n    if (videoPlayer) {\n      videoPlayer.pause();\n      videoPlayer.src = '';\n    }\n\n    this.selectedVideoPath = null;\n    this.videoDuration = 0;\n  }\n\n  private showError(message: string): void {\n    const modal = document.getElementById('error-modal');\n    const errorMessage = document.getElementById('error-message');\n\n    if (modal && errorMessage) {\n      errorMessage.textContent = message;\n      modal.classList.add('active');\n    }\n\n    console.error(message);\n  }\n\n  private hideError(): void {\n    const modal = document.getElementById('error-modal');\n    if (modal) {\n      modal.classList.remove('active');\n    }\n  }\n\n  private showSuccess(message: string): void {\n    // Simple toast notification\n    const toast = document.createElement('div');\n    toast.textContent = message;\n    toast.style.cssText = `\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      background: #44ff44;\n      color: #000;\n      padding: 1rem 2rem;\n      border-radius: 8px;\n      font-weight: 600;\n      z-index: 10000;\n    `;\n    document.body.appendChild(toast);\n\n    setTimeout(() => {\n      toast.remove();\n    }, 2000);\n  }\n}\n\n// Initialize app when DOM is ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => {\n    new LocalWatchApp();\n  });\n} else {\n  new LocalWatchApp();\n}\n"],"names":["module","exports","require","codes","createErrorType","code","message","Base","Error","NodeError","_Base","subClass","superClass","arg1","arg2","arg3","call","this","getMessage","prototype","Object","create","constructor","__proto__","name","oneOf","expected","thing","Array","isArray","len","length","map","i","String","concat","slice","join","value","TypeError","actual","determiner","search","msg","str","start","substr","replace","this_len","undefined","substring","endsWith","type","indexOf","arg","assign","obj","props","key","defineProperty","enumerable","configurable","err","_","stack","ErrClass","getPrototypeOf","globalThis","wrtc","RTCPeerConnection","mozRTCPeerConnection","webkitRTCPeerConnection","RTCSessionDescription","mozRTCSessionDescription","webkitRTCSessionDescription","RTCIceCandidate","mozRTCIceCandidate","webkitRTCIceCandidate","ICE_SERVERS","urls","isHost","peer","roomCode","onMessageCallback","onStatusCallback","connectedPeers","Map","initAsHost","generateRoomCode","updateStatus","Promise","resolve","reject","initiator","trickle","config","iceServers","setupPeerListeners","on","signal","signalData","JSON","stringify","console","log","error","joinRoom","hostSignal","parsedSignal","parse","connectWithGuest","guestSignal","data","toString","sendMessage","destroyed","send","warn","broadcast","forEach","onMessage","callback","onStatusChange","status","charAt","Math","floor","chars","random","getRoomCode","getSignalData","timeout","setTimeout","clearTimeout","isConnected","disconnect","destroy","clear","Buffer","isEncoding","encoding","toLowerCase","StringDecoder","nb","enc","nenc","retried","_normalizeEncoding","normalizeEncoding","text","utf16Text","end","utf16End","fillLast","utf8FillLast","base64Text","base64End","write","simpleWrite","simpleEnd","lastNeed","lastTotal","lastChar","allocUnsafe","utf8CheckByte","byte","buf","p","r","self","utf8CheckExtraBytes","copy","c","charCodeAt","n","total","j","utf8CheckIncomplete","MAX_BYTES","crypto","global","msCrypto","getRandomValues","size","cb","RangeError","bytes","generated","process","nextTick","ERR_STREAM_PREMATURE_CLOSE","noop","eos","stream","opts","called","_len","arguments","args","_key","apply","once","readable","writable","onlegacyfinish","onfinish","writableEnded","_writableState","finished","readableEnded","_readableState","endEmitted","onend","onerror","onclose","ended","onrequest","req","setHeader","abort","isRequest","removeListener","ERR_INVALID_OPT_VALUE","getHighWaterMark","state","options","duplexKey","isDuplex","hwm","highWaterMark","highWaterMarkFrom","isFinite","objectMode","objectKeys","keys","push","Duplex","Readable","Writable","v","method","allowHalfOpen","onEndNT","get","getBuffer","set","Stream","Transform","PassThrough","pipeline","ReadableState","debug","EElistenerCount","emitter","listeners","OurUint8Array","window","Uint8Array","debugUtil","debuglog","createReadableStreamAsyncIterator","from","BufferList","destroyImpl","_require$codes","ERR_INVALID_ARG_TYPE","ERR_STREAM_PUSH_AFTER_EOF","ERR_METHOD_NOT_IMPLEMENTED","ERR_STREAM_UNSHIFT_AFTER_END_EVENT","errorOrDestroy","kProxyEvents","readableObjectMode","buffer","pipes","pipesCount","flowing","reading","sync","needReadable","emittedReadable","readableListening","resumeScheduled","paused","emitClose","autoDestroy","defaultEncoding","awaitDrain","readingMore","decoder","read","_read","_destroy","readableAddChunk","chunk","addToFront","skipChunkCheck","er","emitReadable","emitReadable_","onEofChunk","isBuffer","chunkInvalid","_uint8ArrayToBuffer","addChunk","maybeReadMore","emit","unshift","_undestroy","undestroy","isPaused","setEncoding","head","content","next","MAX_HWM","howMuchToRead","computeNewHighWaterMark","flow","maybeReadMore_","updateReadableListening","listenerCount","resume","nReadingNextTick","resume_","fromList","ret","shift","first","consume","endReadable","endReadableNT","wState","xs","x","l","parseInt","nOrig","doRead","pipe","dest","pipeOpts","src","endFn","stdout","stderr","unpipe","onunpipe","unpipeInfo","hasUnpiped","ondrain","ondata","cleanedUp","needDrain","pipeOnDrain","pause","event","fn","prependListener","_events","dests","index","splice","ev","res","addListener","removeAllListeners","wrap","_this","bind","Symbol","asyncIterator","_fromList","iterable","s","m","h","d","w","plural","ms","msAbs","isPlural","round","val","match","exec","parseFloat","long","abs","fmtShort","promise","queueMicrotask","then","catch","_transform","ERR_MULTIPLE_CALLBACK","ERR_TRANSFORM_ALREADY_TRANSFORMING","ERR_TRANSFORM_WITH_LENGTH_0","afterTransform","ts","_transformState","transforming","writecb","writechunk","rs","needTransform","writeencoding","transform","flush","_flush","prefinish","done","_write","err2","localStorage","warned","trace","ctor","superCtor","super_","TempCtor","CorkedRequest","entry","finish","corkReq","pendingcb","onCorkedFinish","corkedRequestsFree","WritableState","realHasInstance","internalUtil","deprecate","ERR_STREAM_CANNOT_PIPE","ERR_STREAM_DESTROYED","ERR_STREAM_NULL_VALUES","ERR_STREAM_WRITE_AFTER_END","ERR_UNKNOWN_ENCODING","nop","writableObjectMode","finalCalled","ending","noDecode","decodeStrings","writing","corked","bufferProcessing","onwrite","writelen","onwriteStateUpdate","finishMaybe","errorEmitted","onwriteError","needFinish","bufferedRequest","clearBuffer","afterWrite","lastBufferedRequest","prefinished","bufferedRequestCount","writev","_writev","final","_final","doWrite","onwriteDrain","holder","count","allBuffers","isBuf","callFinal","need","rState","current","out","hasInstance","Function","object","writeAfterEnd","validChunk","newChunk","decodeChunk","last","writeOrBuffer","cork","uncork","setDefaultEncoding","endWritable","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","target","source","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","_defineProperties","descriptor","input","prim","toPrimitive","hint","_toPrimitive","inspect","custom","copyBuffer","offset","instance","Constructor","_classCallCheck","tail","protoProps","alloc","hasStrings","_getString","_getBuffer","depth","customInspect","env","createDebug","namespace","prevTime","namespacesCache","enabledCache","enableOverride","enabled","curr","Number","Date","diff","prev","coerce","format","formatter","formatters","formatArgs","useColors","color","selectColor","extend","namespaces","init","delimiter","newDebug","matchesTemplate","template","searchIndex","templateIndex","starIndex","matchIndex","default","disable","names","skips","enable","save","split","trim","Boolean","ns","skip","humanize","hash","colors","load","ERR_MISSING_ARGS","to","streams","pop","popCallback","destroys","closed","destroyer","reduce","getBrowserRTC","randombytes","errCode","MAX_BUFFERED_AMOUNT","filterTrickle","sdp","Peer","super","_id","_debug","channelName","channelConfig","channelNegotiated","negotiated","offerOptions","answerOptions","sdpTransform","allowHalfTrickle","iceCompleteTimeout","destroying","_connected","remoteAddress","remoteFamily","remotePort","localAddress","localFamily","localPort","_wrtc","_pcReady","_channelReady","_iceComplete","_iceCompleteTimer","_channel","_pendingCandidates","_isNegotiating","_firstNegotiation","_batchedNegotiation","_queuedNegotiation","_sendersAwaitingStable","_senderMap","_closingInterval","_remoteTracks","_remoteStreams","_chunk","_cb","_interval","_pc","_isReactNativeWebrtc","_peerConnectionId","oniceconnectionstatechange","_onIceStateChange","onicegatheringstatechange","onconnectionstatechange","_onConnectionStateChange","onsignalingstatechange","_onSignalingStateChange","onicecandidate","_onIceCandidate","peerIdentity","_setupData","channel","createDataChannel","ondatachannel","addStream","ontrack","_onTrack","_needsNegotiation","_onFinishBound","_onFinish","bufferSize","bufferedAmount","connected","readyState","address","port","family","renegotiate","transceiverRequest","addTransceiver","kind","candidate","remoteDescription","_addIceCandidate","setRemoteDescription","_createAnswer","iceCandidateObj","addIceCandidate","getTracks","track","addTrack","submap","sender","removed","replaceTrack","oldTrack","newTrack","removeTrack","removeStream","negotiate","_createOffer","clearInterval","close","onmessage","onopen","binaryType","bufferedAmountLowThreshold","label","_onChannelMessage","onbufferedamountlow","_onChannelBufferedAmountLow","_onChannelOpen","_onChannelClose","filename","lineno","colno","isClosing","setInterval","destroySoon","_startIceCompleteTimeout","createOffer","offer","sendOffer","localDescription","setLocalDescription","_requestMissingTransceivers","getTransceivers","transceiver","mid","requested","createAnswer","answer","sendAnswer","connectionState","iceConnectionState","iceGatheringState","_maybeReady","getStats","flattenValues","report","values","reports","result","stat","id","timestamp","_connecting","findCandidatePair","items","remoteCandidates","localCandidates","candidatePairs","foundSelectedCandidatePair","item","setSelectedCandidatePair","selectedCandidatePair","local","localCandidateId","ip","ipAddress","portNumber","googLocalAddress","includes","remote","remoteCandidateId","googRemoteAddress","selectedCandidatePairId","googActiveConnection","selected","_onInterval","unref","signalingState","sdpMLineIndex","sdpMid","ArrayBuffer","eventStream","some","remoteStream","WEBRTC_SUPPORT","sdpSemantics","lastC","storage","setItem","removeItem","getItem","DEBUG","__nwjs","navigator","userAgent","document","documentElement","style","WebkitAppearance","firebug","exception","table","localstorage","copyProps","dst","SafeBuffer","encodingOrOffset","allocUnsafeSlow","fill","SlowBuffer","emitErrorAndCloseNT","emitErrorNT","emitCloseNT","readableDestroyed","writableDestroyed","_Object$setPrototypeO","kLastResolve","kLastReject","kError","kEnded","kLastPromise","kHandlePromise","kStream","createIterResult","readAndResolve","iter","onReadable","AsyncIteratorPrototype","ReadableStreamAsyncIteratorPrototype","setPrototypeOf","lastPromise","wrapForNext","_this2","_Object$create","iterator","connection","videoElement","syncInterval","onStateUpdateCallback","videoDuration","lastSyncTime","driftThreshold","hardSeekThreshold","syncIntervalMs","setupMessageHandler","setVideoElement","duration","setupVideoListeners","startSyncLoop","addEventListener","handleLocalPlay","handleLocalPause","handleLocalSeek","isPlaying","position","currentTime","now","handleSyncMessage","applyPlay","applyPause","applySeek","applySync","userId","sendCurrentState","play","elapsed","expectedPosition","drift","adjustment","playbackRate","toFixed","sendSyncUpdate","notifyReady","onStateUpdate","cleanup","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","LocalWatchApp","currentScreen","syncManager","selectedVideoPath","generateUserId","initializeEventListeners","getElementById","showCreateRoom","showJoinRoom","showHome","selectVideo","copyRoomCode","copyHostSignal","connectGuest","startWatching","copyGuestSignal","exitPlayer","togglePlayPause","toggleFullscreen","seekBar","handleSeekBarInput","handleSeek","hideError","showScreen","screenId","querySelectorAll","screen","classList","remove","add","mode","filePath","electronAPI","selectVideoFile","displayElement","textContent","createRoom","showError","P2PConnection","handleConnectionStatus","roomCodeElement","signalOutput","display","connectedCount","toUpperCase","guestSignalOutput","statusElement","videoPlayer","onloadedmetadata","SyncManager","updateTimeDisplay","roomCodeDisplay","playPauseBtn","time","timeDisplay","formatTime","seconds","padStart","playerContainer","querySelector","fullscreenElement","exitFullscreen","requestFullscreen","statusDot","statusText","clipboard","writeText","showSuccess","modal","errorMessage","toast","createElement","cssText","body","appendChild"],"ignoreList":[],"sourceRoot":""}